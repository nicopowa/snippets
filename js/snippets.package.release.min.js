/**
 * snippets package release
 * Â© 2024 ILUSIO / NICO PR
 * The Closure Library Authors - Apache-2.0
 */
(function(){
var g=this||self;function k(a){a=a.split(".");var b=g;a[0]in b||"undefined"==typeof b.execScript||b.execScript("var "+a[0]);for(var c;a.length&&(c=a.shift());)a.length?b[c]&&b[c]!==Object.prototype[c]?b=b[c]:b=b[c]={}:b[c]=!1};k("DEBUG");k("STAND");function m(a,b,...c){a=document.createElement(a);c.length&&n(a,...c);b&&b.appendChild(a);return a}function n(a,...b){a.classList.add(...b)}function p(a,...b){a.classList.remove(...b)}function q(a,...b){b.forEach(c=>a.classList.toggle(c))}
function r(){const a=(...b)=>b.map(c=>JSON.stringify(c,(d,e)=>{if(!e)return String(e);if("function"===typeof e)return e.toString();if(e instanceof ErrorEvent)return JSON.stringify(Object.getOwnPropertyNames(Object.getPrototypeOf(e)).reduce((f,h)=>({...f,[h]:e[h]}),{}),null,"\t");if(e instanceof Error)return e.toString();if(e instanceof PromiseRejectionEvent)return e.reason.toString();if(e instanceof Element)return(new XMLSerializer).serializeToString(e).replace(/\sxmlns="[^"]+"/,"");if(e instanceof
Map){let f={};e.forEach((h,l)=>{f[l.toString()]=h});return JSON.stringify(f)}if(e instanceof Set){let f=[];e.forEach(h=>f.push(h));return JSON.stringify(f).replace(/^\[/,"{").replace(/\]$/,"}")}return"object"===typeof e?JSON.stringify(e):e},"\t"));["log","warn","error","evt","perf"].forEach(b=>{console[b]=(...c)=>{window.parent.postMessage([...a(b,...c)],"{o}")}});window.addEventListener("unhandledrejection",b=>console.error(b));window.addEventListener("error",b=>console.error(b))}
function t(){window.addEventListener("load",async()=>{pre();let a=performance.now(),b=0,c=()=>{js()};for(;1E3>=performance.now()-a;)c(),b++;post();console.perf(b)})}function u(){window.addEventListener("load",async()=>{console.evt("load");try{pre(),js(),post()}catch(a){console.error(a)}})}function v(a){let b=w.find(c=>c.C&&c.C.contentWindow===a.source);b&&b.V.apply(b,a.data.map(c=>JSON.parse(c)))}function x(a){var b=w.findIndex(c=>c.I===a);-1!==b&&(b=w.splice(b,1)[0],b.j&&b.j.remove(),b=null)}
function y(a){let b="calc("+a.O+"rem + 0.5rem)";var c=a.C;c.style.minHeight=c.style.maxHeight=c.style.height=b;a=a.l;a.style.minHeight=a.style.maxHeight=a.style.height=b}function z(a){a.s?document.fullscreenElement?document.exitFullscreen():a.j.requestFullscreen():q(a.j,"full","force")}
function A(a){clearTimeout(a.B);a.fa();if(!a.g.length)for(;a.h.firstChild;)a.h.removeChild(a.h.lastChild);let b=a.da.map(c=>w.find(d=>(d.F===c||"#"+d.I===c)&&d.I!=a.I)).filter(Boolean).reduce((c,d)=>{/^p/.test(d.G)?c[d.G]+=d.J+"\n":c[d.N]+=d.J+"\n";return c},{html:"",css:"",js:"",pre:"",post:""});b[a.N]+=a.J;a.m.removeChild(a.C);a.C.srcdoc=B(a,b);a.l.before(a.C);p(a.j,"err");n(a.o.firstChild,"ing")}
function B(a,b){let c=/^[^{]+\{([\s\S]+)\}$/g,d=e=>'onerror="console.error(new URIError(event.target.'+e+'));"';return['<html>\n<head>\n<meta http-equiv="content-type" content="text/html; charset=UTF-8">\n<style>\nhtml,body{margin:0;padding:0;width:100%;}\nhtml{height:100%;}\nbody{position:absolute;height:100%;min-height:100%;}',b.css,"</style>",...a.ba.map(e=>'<link rel="stylesheet" href="'+e+'" '+d("href")+"/>"),"<script>",r.toString().replace(c,"$1").replace(/\{o\}/g,location.origin),"\x3c/script>",
...a.ca.map(e=>'<script src="'+e+'" '+d("src")+">\x3c/script>"),"<script"+(a.ea?' type="module"':"")+">",("perf"===a.G?t:u).toString().replace(c,"$1").replace(/(pre|js|post)\(\);?,?/g,(e,f)=>"\n"+b[f].replace(/(console[^)]+\);?)/g,(h,l)=>"perf"===a.G?"":l)+"\n"),"\x3c/script>\n</head>\n<body>",b.html,"</body>\n</html>"].join("\n")}
function C(a,b){a.g.push(b);a.V("log",a.g.length+".",Math.round(b),"ops");9>a.g.length?setTimeout(()=>A(a),5):(a.g.sort((c,d)=>c-d),a.V("log","ops/s median",Math.round((a.g[a.g.length-1>>1]+a.g[a.g.length>>1])/2),"avg",Math.round(a.g.reduce((c,d)=>c+d,0)/a.g.length)),a.g=[])}function D(a,b){"load"===b&&(a.B=setTimeout(()=>p(a.o.firstChild,"ing"),1E3))}
function aa(a,b,...c){let d=new Date,e=m("span",a.h,"snip-"+b);e.setAttribute("data-time",(new Date(d-6E4*d.getTimezoneOffset())).toISOString().slice(-13,-1));for(e.textContent=c.join(" ");128<a.h.childElementCount;)a.h.firstChild.remove();a.l.scrollTo(0,a.l.scrollHeight);"error"==b&&a.j.classList.contains("nolog")&&n(a.j,"err")}
class E{constructor(a,b=0){this.qa=a;this.I=b||++F;if(b=JSON.parse(decodeURI(a.getAttribute("data-snip")||(/(\{[^}]+\})/.exec(this.J.split("\n",1)[0])||[0]).pop())))this.F=b.name||"",this.N=/language-(\w+)/.exec(a.className)[1].replace(/j.+t/,"js"),this.G=b.hasOwnProperty("type")?b.type:"run",this.B=-1,this.fa=()=>{},this.da=b.link||[],this.ba=b.css||[],this.ca=b.js||[],this.ea=!0===b.module,this.g=[],this.s=!0,this.A=null,["run","perf"].includes(this.G)&&(this.j=m("div",null,"snip"),!1!==b.insert&&
a.parentNode.after(this.j),this.o=m("span",this.j),this.o.addEventListener("click",c=>{c=c.target;switch([...c.parentNode.children].indexOf(c)){case 0:A(this);break;case 1:z(this);break;case 2:q(this.j,"noone");break;case 3:q(this.j,"nolog");p(this.j,"err");break;case 4:this.O--;y(this);break;case 5:this.O++,y(this)}}),Array(6).fill(0).forEach(()=>m("div",this.o)),this.m=m("div",this.j),this.C=m("iframe",this.m),this.C.sandbox="allow-scripts",this.l=m("div",this.m),this.h=m("div",this.l),!1===b.body&&
n(this.j,"noone"),!1===b.console&&n(this.j,"nolog"),a=m("a",this.m),a.href="//snipp.et",a.target="_blank",this.O=+(b.height||12),y(this),document.fullscreenEnabled?this.j.addEventListener("fullscreenchange",()=>(document.fullscreenElement?n:p).apply(E,[this.j,"full"])):(this.s=!1,this.A=m("span",this.j,"back"),this.A.addEventListener("click",()=>z(this)))),w.push(this)}V(...a){let b=a.shift();"perf"===b?C(this,+a[0]):"evt"===b?D(this,...a):aa(this,b,...a)}get id(){return this.I}get ga(){return this.j}get frame(){return this.C}get size(){return this.O}get J(){return this.qa.innerText.replace(/\u200B/g,
"")}set Fa(a){this.fa=a}set module(a){this.ea=a}set u(a){this.ca=a}set links(a){this.da=a}set Ga(a){this.ba=a}}var F,w;F=0;w=[];window.addEventListener("message",a=>v(a),!1);function G(a,b=document.body){return b.querySelector(a)}function H(a,...b){return I(a,"div","",...b)}function I(a,b,c,...d){b=document.createElement(b);c&&(b.innerHTML=c);J(b,...d);a&&a.appendChild(b);return b}function ba(a){a.l=JSON.parse(window.localStorage.getItem(a.F)||"[]");a.l.forEach(b=>K(a,b))}
function ca(a){L(a,a.oa,a.ya);L(a,a.pa,a.R);(new Map([[a.wa,a.Y],[a.ja,a.ka],[a.L,a.aa],[a.X,a.ra],[a.ia,a.xa],[a.Z,a.ta],[a.Da,a.ua]])).forEach((b,c)=>L(a,c,b));L(a,document,b=>{(b.ctrlKey||b.metaKey)&&"rs".includes(b.key)&&(b.preventDefault(),"s"===b.key?a.aa(b):"r"===b.key&&A(a.g.js[0]))},"keydown");L(a,a.A,b=>b.target.classList.contains("cmd")&&M(a,b.target));window.addEventListener("hashchange",()=>N(a),!1)}function N(a){a.R();O(a);da(a).then(b=>P(a,b))}
function L(a,b,c,d="click"){b.addEventListener(d,e=>c.bind(a)(e))}function M(a,b){let c=a.ha.find(d=>b.classList.contains(d));a.W.hasOwnProperty(c)&&a.W[c].bind(a)(b)}function O(a){a.h&&a.A.remove();a.h=a.m.value=document.title="";Object.keys(a.g).forEach(b=>{a.g[b].forEach(c=>{x(c.id)});a.g[b]=[];a.o[b].forEach(()=>{});a.o[b]=[];a.u[b].forEach(c=>{c.remove()});a.u[b]=[]})}function da(a){let b=location.hash.slice(1);return 20>=b.length?ea(a,b):Q(b)}
function P(a,b){window.scroll(0,0);b||(b={},R());a.m.value=document.title=b.t||"untitled";a.s=b.v||0;a.T={...a.Ba,...("string"===typeof b.r?JSON.parse(b.r||"{}"):b.r)};a.B.forEach(d=>{a.g[d]=[];a.u[d]=[];a.o[d]=[];Array.isArray(b[d])||(b[d]=[b[d]]);let e=a.U.get(d);b[d].forEach((f,h)=>{S(a,d,"js"!==d||h?{name:d+"-"+h,type:""}:a.T,f,e.firstChild)})});let c=a.g.js[0];a.Ca.appendChild(c.ga);c.frame.title=a.m.value;c.Fa=()=>fa(a);a.h?(a.K.appendChild(a.A),T(a.L,"no"),a.M()):(Object.keys(b).length||R(),
U(a));V(a);a.B.slice(-3).flatMap(d=>a.g[d].map(e=>e.J.length)).some(d=>0<d)&&A(a.g.js[0])}async function ea(a,b){return a.l.some(c=>c.i===b)?(a.h=b,await Q(window.localStorage.getItem("snippet-"+b)||"")):null}async function Q(a){try{let b=(await ha(a)).trim();return b.startsWith("md=")||b.startsWith("html=")?Object.fromEntries(new URLSearchParams(b)):JSON.parse(b)}catch(b){return console.error(b),null}}
async function ha(a){return await (new Response((new Response(Uint8Array.from(atob(a),b=>b.charCodeAt(0)))).body.pipeThrough(new DecompressionStream("gzip")))).text()}function R(){history.pushState("",document.title,window.location.pathname+window.location.search)}
function S(a,b,c,d,e){e=H(e,"code");let f=I(e,"pre","","prism-live","line-numbers");var h=I(f,"code","","code","language-"+b);W(h,"data-snip",encodeURI(JSON.stringify(c)));h.textContent=d;c=H(f,"lang");W(c,"lang",b);a.u[b].push(e);c=new Prism.Live(f);W(c.textarea,"aria-label","code-"+b);a.o[b].push(c);h=new E(h);a.g[b].push(h);e=H(e,"ctool");c=H(e,"cmd","add",b);W(c,"lang",b);H(e,"spc");c=H(e,"cmd","rem");W(c,{lang:b,snip:h.id});H(c,"cmd","rem-yes");H(c,"cmd","rem-no");L(a,e,l=>l.target.classList.contains("cmd")&&
M(a,l.target))}function fa(a){window.scroll(0,0);ia(a);let b=a.B.map(c=>a.g[c].map(d=>"#"+d.id));b[b.length-1].reverse();a.g.js[0].links=b.flat()}function T(a,...b){a.classList.remove(...b)}function U(a){J(a.L,"no")}function V(a){document.title=a.m.value;a.Ea.innerHTML="v"+Math.floor(a.s/100)+"."+a.s.toString().padStart(3,"0").slice(-2).split("").join(".")}function W(a,b,c=""){"string"===typeof b&&(b={[b]:c});Object.keys(b).forEach(d=>a.setAttribute(d,b[d]))}
function ja(a,b,c){x(a.g[b][c].id);a.o[b][c]=null;a.u[b][c].remove();[a.g,a.o,a.u].forEach(d=>d[b].splice(c,1));U(a)}function ia(a){var b={js:[],css:[]};b=Object.keys(b).reduce((c,d)=>{Array.from(a.o.md[0].textarea.value.matchAll(new RegExp("^@("+d+")\\s(.+)$","gm"))).forEach(e=>c[e[1]].push(e[2]));return c},b);Object.assign(a.g.js[0],{u:b.js,Ga:b.css})}function J(a,...b){a.classList.add(...b)}function K(a,b){a=I(a.P,"li","","menuitem");a=I(a,"a",b.t);W(a,"href","#"+b.i)}
async function ka(a){return btoa((new Uint8Array(await (new Response((new Response(a)).body.pipeThrough(new CompressionStream("gzip")))).arrayBuffer())).reduce((b,c)=>b+String.fromCharCode(c),""))}async function X(a,b={}){let c=a.g.js[0],d=c.ga;b=JSON.stringify({...a.B.reduce((e,f)=>({...e,[f]:a.o[f].map(h=>h.textarea.value)}),{t:a.m.value,r:{...a.T,height:c.size,body:!d.classList.contains("noone"),console:!d.classList.contains("nolog")},...b})});return await ka(b)}
function la(a){history.replaceState(a,"","#"+a)}function Y(a){window.localStorage.setItem(a.F,JSON.stringify(a.l))}function Z(a){T(a,"no");J(a,"yes");setTimeout(()=>T(a,"yes"),750)}async function ma(a){for await(let b of a.values());}
class na{constructor(){this.F="snippets";this.B=["md","html","css","js"];this.ha="add rem rem-yes rem-no del del-yes del-no".split(" ");this.W={add:this.la,rem:this.na,["rem-yes"]:this.za,["rem-no"]:this.Aa,del:this.ma,["del-yes"]:this.sa,["del-no"]:this.M};this.Ba={name:"js",type:"run",height:18,body:!0,console:!0,insert:!1,js:[],css:[]};this.h="";this.s=0;this.T={};this.u={};this.g={};this.o={};this.l=[];this.H=G(".header");this.K=G(".content");this.$=G(".menu");this.D=G(".menutools");this.va=G(".menulists");
this.P=G(".menulist");this.oa=H(this.H,"menubtn","hide");this.pa=H(this.D,"closebtn");this.Ca=H(this.K,"wrap");this.m=I(this.H,"input","","snippet-title");this.m.placeholder="title...";H(this.H,"spc");this.L=H(this.H,"save");this.X=H(this.H,navigator.canShare?"share":"copy");this.wa=H(this.D,"create");this.ja=H(this.D,"about");this.ia=H(this.D,"open");this.Z=H(this.D,"export");this.Da=H(this.D,"import");this.A=H(null,"cmds");this.Ea=H(this.A,"ver");this.S=H(this.A,"cmd","del");H(this.S,"cmd","del-yes");
H(this.S,"cmd","del-no");this.U=new Map;this.B.forEach(a=>{let b=H(this.K,"lwrap");H(b,"lcode");this.U.set(a,b)});ba(this);ca(this);"serviceWorker"in navigator&&navigator.serviceWorker.register("js/snippets.package-service.release.min.js",{});N(this)}ya(){T(this.$,"hide");this.va.scrollTop=0}R(){J(this.$,"hide")}Y(){this.R();O(this);R();P(this)}ka(){window.open("https://github.com/nicopowa/snippets","_blank")}async aa(){if(this.h){var a=this.l.find(b=>b.i===this.h);a&&(this.s++,a.t=this.m.value,a.v=
this.s,G("[href='#"+this.h+"']",this.P).innerHTML=a.t)}else this.h=Date.now().toString(36)+Math.random().toString(36).slice(2),this.s=0,a={i:this.h,v:this.s,t:this.m.value},this.l.push(a),K(this,a),this.K.appendChild(this.A),la(this.h);window.localStorage.setItem("snippet-"+this.h,await X(this,{i:this.h,v:this.s}));Y(this);V(this);this.M();Z(this.L)}la(a){let b=this.B.find(c=>a.classList.contains(c));S(this,b,{name:b+"-"+this.u[b].length,type:""},"",this.U.get(b).firstChild);U(this)}na(a){J(a,"ask")}za(a){a=
a.parentNode;let b=a.getAttribute("snip");a=a.getAttribute("lang");let c=this.g[a].findIndex(d=>d.id==b);ja(this,a,c);U(this)}Aa(a){T(a.parentElement,"ask")}ma(a){J(a,"ask")}sa(){this.l.splice(this.l.findIndex(a=>a.i===this.h),1);Y(this);G("[href='#"+this.h+"']",this.P).parentNode.remove();window.localStorage.removeItem("snippet-"+this.h);this.M();this.Y()}M(){T(this.S,"ask")}async ra(){let a=location.origin+location.pathname+"#"+await X(this);navigator.canShare?navigator.share({title:this.m.value,
url:a}):navigator.clipboard&&navigator.clipboard.writeText(a).then(()=>Z(this.X))}async xa(){window.showDirectoryPicker().then(a=>ma(a)).catch(()=>{})}ta(){let a=this.l.reduce((c,d)=>{d=d.i;c[d]=window.localStorage.getItem("snippet-"+d)||"";return c},{[this.F]:this.l}),b=document.createElement("a");W(b,{href:"data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a)),download:this.F+".json"});b.style.display="none";document.body.appendChild(b);b.click();b.remove();Z(this.Z)}ua(){let a=
document.createElement("input");a.type="file";a.accept="application/json";a.style.display="none";document.body.appendChild(a);a.addEventListener("change",()=>{if(a.files.length){let b=a.files[0],c=new FileReader;c.addEventListener("loadend",d=>{try{let e=JSON.parse(d.target.result);e.snippets.filter(f=>e[f.i]).forEach(f=>{let h=this.l.find(l=>l.i===f.i);if(h&&h.v>h.v||!h)window.localStorage.setItem("snippet-"+f.i,e[f.i]),K(this,f),this.l.push(f),Y(this)})}catch(e){}});c.readAsText(b)}a.remove()});
a.click()}};window.addEventListener("load",()=>new na);}).call(this);
