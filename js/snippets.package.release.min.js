/**
 * snippets package release
 * Â© 2024 ILUSIO / NICO PR
 * The Closure Library Authors - Apache-2.0
 */
(function(){
var h=this||self;function k(a){a=a.split(".");var b=h;a[0]in b||"undefined"==typeof b.execScript||b.execScript("var "+a[0]);for(var c;a.length&&(c=a.shift());)a.length?b[c]&&b[c]!==Object.prototype[c]?b=b[c]:b=b[c]={}:b[c]=!1};k("DEBUG");k("STAND");function l(a,b,...c){a=document.createElement(a);c.length&&m(a,...c);b&&b.appendChild(a);return a}function m(a,...b){a.classList.add(...b)}function p(a,...b){a.classList.remove(...b)}function q(a,...b){b.forEach(c=>a.classList.toggle(c))}
function r(){const a=(...b)=>b.map(c=>JSON.stringify(c,(d,e)=>{if(!e)return String(e);if("function"===typeof e)return e.toString();if(e instanceof ErrorEvent)return JSON.stringify(Object.getOwnPropertyNames(Object.getPrototypeOf(e)).reduce((f,g)=>({...f,[g]:e[g]}),{}),null,"\t");if(e instanceof Error)return e.toString();if(e instanceof PromiseRejectionEvent)return e.reason.toString();if(e instanceof Element)return(new XMLSerializer).serializeToString(e).replace(/\sxmlns="[^"]+"/,"");if(e instanceof
Map){let f={};e.forEach((g,n)=>{f[n.toString()]=g});return JSON.stringify(f)}if(e instanceof Set){let f=[];e.forEach(g=>f.push(g));return JSON.stringify(f).replace(/^\[/,"{").replace(/\]$/,"}")}return"object"===typeof e?JSON.stringify(e):e},"\t"));["log","warn","error","evt","perf"].forEach(b=>{console[b]=(...c)=>{window.parent.postMessage([...a(b,...c)],"{o}")}});window.addEventListener("unhandledrejection",b=>console.error(b));window.addEventListener("error",b=>console.error(b))}
function t(){window.addEventListener("load",async()=>{pre();let a=performance.now(),b=0,c=()=>{js()};for(;1E3>=performance.now()-a;)c(),b++;post();console.perf(b)})}function u(){window.addEventListener("load",async()=>{console.evt("load");try{pre(),js(),post()}catch(a){console.error(a)}})}function v(a){let b=w.find(c=>c.B&&c.B.contentWindow===a.source);b&&b.P.apply(b,a.data.map(c=>JSON.parse(c)))}function x(a){var b=w.findIndex(c=>c.R===a);-1!==b&&(b=w.splice(b,1)[0],b.h&&b.h.remove(),b=null)}
function y(a){let b="calc("+a.L+"rem + 0.5rem)";var c=a.B;c.style.minHeight=c.style.maxHeight=c.style.height=b;a=a.j;a.style.minHeight=a.style.maxHeight=a.style.height=b}function z(a){a.s?document.fullscreenElement?document.exitFullscreen():a.h.requestFullscreen():q(a.h,"full","force")}
function A(a){clearTimeout(a.A);if(!a.g.length)for(;a.l.firstChild;)a.l.removeChild(a.l.lastChild);let b=w.filter(c=>a.C.includes(c.D)||a.C.includes("#"+c.R)).reduce((c,d)=>{/^p/.test(d.F)?c[d.F]+=d.J+"\n":c[d.K]+=d.J+"\n";return c},{html:"",css:"",js:"",pre:"",post:""});b[a.K]+=a.J;a.m.removeChild(a.B);a.B.srcdoc=C(a,b);a.j.before(a.B);p(a.h,"err");m(a.o.firstChild,"ing")}
function C(a,b){let c=/^[^{]+\{([\s\S]+)\}$/g,d=e=>'onerror="console.error(new URIError(event.target.'+e+'));"';return['<html>\n<head>\n<meta http-equiv="content-type" content="text/html; charset=UTF-8">\n<style>\nhtml,body{margin:0;padding:0;width:100%;}\nhtml{height:100%;}\nbody{position:absolute;height:100%;min-height:100%;}',b.css,"</style>",...a.Z.map(e=>'<link rel="stylesheet" href="'+e+'" '+d("href")+"/>"),"<script>",r.toString().replace(c,"$1").replace(/\{o\}/g,location.origin),"\x3c/script>",
...a.$.map(e=>'<script src="'+e+'" '+d("src")+">\x3c/script>"),"<script"+(a.aa?' type="module"':"")+">",("perf"===a.F?t:u).toString().replace(c,"$1").replace(/(pre|js|post)\(\);?,?/g,(e,f)=>"\n"+b[f].replace(/(console[^)]+\);?)/g,(g,n)=>"perf"===a.F?"":n)+"\n"),"\x3c/script>\n</head>\n<body>",b.html,"</body>\n</html>"].join("\n")}
function D(a,b){a.g.push(b);a.P("log",a.g.length+".",Math.round(b),"ops");9>a.g.length?setTimeout(()=>A(a),5):(a.g.sort((c,d)=>c-d),a.P("log","ops/s median",Math.round((a.g[a.g.length-1>>1]+a.g[a.g.length>>1])/2),"avg",Math.round(a.g.reduce((c,d)=>c+d,0)/a.g.length)),a.g=[])}function E(a,b){"load"===b&&(a.A=setTimeout(()=>p(a.o.firstChild,"ing"),1E3))}
function F(a,b,...c){let d=new Date,e=l("span",a.l,"snip-"+b);e.setAttribute("data-time",(new Date(d-6E4*d.getTimezoneOffset())).toISOString().slice(-13,-1));e.textContent=c.join(" ");a.j.scrollTo(0,a.j.scrollHeight);"error"==b&&a.h.classList.contains("nolog")&&m(a.h,"err")}
class G{constructor(a,b=0){this.oa=a;this.R=b||++H;if(b=JSON.parse(decodeURI(a.getAttribute("data-snip")||(/(\{[^}]+\})/.exec(this.J.split("\n",1)[0])||[0]).pop())))this.D=b.name||"",this.K=/language-(\w+)/.exec(a.className)[1].replace(/j.+t/,"js"),this.F=b.hasOwnProperty("type")?b.type:"run",this.A=-1,this.C=b.link||[],this.Z=b.css||[],this.$=b.js||[],this.aa=!0===b.module,this.g=[],this.s=!0,this.u=null,["run","perf"].includes(this.F)&&(this.h=l("div",null,"snip"),!1!==b.insert&&a.parentNode.after(this.h),
this.o=l("span",this.h),this.o.addEventListener("click",c=>{c=c.target;switch([...c.parentNode.children].indexOf(c)){case 0:A(this);break;case 1:z(this);break;case 2:q(this.h,"noone");break;case 3:q(this.h,"nolog");p(this.h,"err");break;case 4:this.L--;y(this);break;case 5:this.L++,y(this)}}),Array(6).fill(0).forEach(()=>l("div",this.o)),this.m=l("div",this.h),this.B=l("iframe",this.m),this.B.sandbox="allow-scripts",this.j=l("div",this.m),this.l=l("div",this.j),!1===b.body&&m(this.h,"noone"),!1===
b.console&&m(this.h,"nolog"),a=l("a",this.m),a.href="//snipp.et",a.target="_blank",this.L=+(b.height||12),y(this),document.fullscreenEnabled?this.h.addEventListener("fullscreenchange",()=>(document.fullscreenElement?m:p).apply(G,[this.h,"full"])):(this.s=!1,this.u=l("span",this.h,"back"),this.u.addEventListener("click",()=>z(this)))),w.push(this)}P(...a){let b=a.shift();"perf"===b?D(this,+a[0]):"evt"===b?E(this,...a):F(this,b,...a)}get id(){return this.R}get ba(){return this.h}get frame(){return this.B}get size(){return this.L}get J(){return this.oa.innerText.replace(/\u200B/g,
"")}set module(a){this.aa=a}set G(a){this.$=a}set qa(a){this.Z=a}}var H,w;H=0;w=[];window.addEventListener("message",a=>v(a),!1);window.addEventListener("load",()=>new aa);function I(a,b=document.body){return b.querySelector(a)}function J(a,...b){return K(a,"div","",...b)}function K(a,b,c,...d){b=document.createElement(b);c&&(b.innerHTML=c);L(b,...d);a&&a.appendChild(b);return b}function ba(a){a.j=JSON.parse(window.localStorage.getItem(a.D)||"[]");a.j.forEach(b=>M(a,b))}
function ca(a){O(a,a.da,a.la);O(a,a.ea,a.N);O(a,a.s,b=>b.target.classList.contains("cmd")&&da(a,b.target));(new Map([[a.ka,a.U],[a.C,a.X],[a.T,a.ga],[a.V,a.ha],[a.ca,a.ia]])).forEach((b,c)=>O(a,c,b));O(a,document,b=>{(b.ctrlKey||b.metaKey)&&"rs".includes(b.key)&&(b.preventDefault(),"s"===b.key?a.X(b):"r"===b.key&&P(a))},"keydown");window.addEventListener("hashchange",()=>Q(a),!1)}function Q(a){a.N();R(a);ea(a).then(b=>S(a,b))}function O(a,b,c,d="click"){b.addEventListener(d,e=>c.bind(a)(e))}
function da(a,b){switch(a.fa.find(c=>b.classList.contains(c))){case "more":console.log("more code");break;case "delete":L(b,"del-yes");break;case "del-yes":fa(a);break;case "del-no":T()}}function R(a){a.g&&a.s.remove();a.g=a.m.value=document.title="";Object.keys(a.l).forEach(b=>{a.l[b].forEach(c=>{x(c.id)});a.l[b]=[];a.u[b].forEach(()=>{});a.u[b]=[];a.G[b].forEach(c=>{c.remove()});a.G[b]=[]})}function ea(a){let b=location.hash.slice(1);return 20>=b.length?ha(a,b):U(b)}
function S(a,b={}){window.scroll(0,0);a.m.value=document.title=document.head.querySelector("meta[property='og:title']").content=b.t||"untitled";a.o=b.v||0;a.O={...a.ma,...("string"===typeof b.r?JSON.parse(b.r||"{}"):b.r)};a.H.forEach(d=>{a.l[d]=[];a.G[d]=[];a.u[d]=[];Array.isArray(b[d])||(b[d]=[b[d]]);let e=a.Y.get(d);b[d].forEach((f,g)=>{var n="js"===d?g?{}:a.O:{name:d,type:""};let B=J(e,"code");K(B,"div",d,"lang");let N=K(B,"pre","","prism-live","line-numbers");g=K(N,"code","","code","language-"+
d);g.setAttribute("data-snip",encodeURI(JSON.stringify(n)));g.textContent=f;a.G[d].push(B);f=new Prism.Live(N);f.textarea.setAttribute("aria-label","code-"+d);a.u[d].push(f);f=new G(g);a.l[d].push(f)})});let c=a.l.js[0];a.na.appendChild(c.ba);c.frame.title=a.m.value;a.g?(a.content.appendChild(a.s),V(a.C,"no"),T()):(Object.keys(b).length||history.pushState("",document.title,window.location.pathname+window.location.search),L(a.C,"no"));W(a);a.H.slice(-3).flatMap(d=>a.l[d].map(e=>e.J.length)).some(d=>
0<d)&&P(a)}async function ha(a,b){return a.j.some(c=>c.i===b)?(a.g=b,await U(window.localStorage.getItem("snippet-"+b)||"")):{}}async function U(a){try{let b=(await ia(a)).trim();return b.startsWith("md=")||b.startsWith("html=")?Object.fromEntries(new URLSearchParams(b)):JSON.parse(b)}catch(b){return console.error(b),{}}}function P(a){window.scroll(0,0);ja(a);A(a.l.js[0])}
async function ia(a){return await (new Response((new Response(Uint8Array.from(atob(a),b=>b.charCodeAt(0)))).body.pipeThrough(new DecompressionStream("gzip")))).text()}function V(a,...b){a.classList.remove(...b)}function T(){V(I(".cmd.delete"),"del-yes")}function L(a,...b){a.classList.add(...b)}function W(a){document.title=a.m.value;a.pa.innerHTML="v"+Math.floor(a.o/100)+"."+a.o.toString().padStart(3,"0").slice(-2).split("").join(".")}
function ja(a){var b={js:[],css:[]};b=Object.keys(b).reduce((c,d)=>{Array.from(a.u.md[0].textarea.value.matchAll(new RegExp("^@("+d+")\\s(.+)$","gm"))).forEach(e=>c[e[1]].push(e[2]));return c},b);Object.assign(a.l.js[0],{G:b.js,qa:b.css})}function fa(a){a.j.splice(a.j.findIndex(b=>b.i===a.g),1);X(a);I("[href='#"+a.g+"']",a.M).parentNode.remove();window.localStorage.removeItem("snippet-"+a.g);T();a.U()}function M(a,b){a=K(a.M,"li","","menuitem");K(a,"a",b.t).setAttribute("href","#"+b.i)}
async function ka(a){return btoa((new Uint8Array(await (new Response((new Response(a)).body.pipeThrough(new CompressionStream("gzip")))).arrayBuffer())).reduce((b,c)=>b+String.fromCharCode(c),""))}async function Y(a,b={}){let c=a.l.js[0],d=c.ba;b=JSON.stringify({...a.H.reduce((e,f)=>({...e,[f]:a.u[f].map(g=>g.textarea.value)}),{t:a.m.value,r:{...a.O,height:c.size,body:!d.classList.contains("noone"),console:!d.classList.contains("nolog")},...b})});return await ka(b)}
function la(a){history.replaceState(a,"","#"+a)}function X(a){window.localStorage.setItem(a.D,JSON.stringify(a.j))}function Z(a){L(a,"yes");setTimeout(()=>V(a,"yes"),750)}
class aa{constructor(){this.D="snippets";this.H=["md","html","css","js"];this.fa=["more","del-yes","del-no","delete"];this.ma={name:"js",type:"run",height:18,body:!0,console:!0,insert:!1,js:[],css:[],link:this.H.slice(1,-1)};this.g="";this.o=0;this.O={};this.G={};this.l={};this.u={};this.j=[];this.A=I(".header");this.content=I(".content");this.W=I(".menu");this.I=I(".menutools");this.ja=I(".menulists");this.M=I(".menulist");this.da=J(this.A,"menubtn","hide");this.ea=J(this.I,"closebtn");this.na=J(this.content,
"wrap");this.m=K(this.A,"input","","snippet-title");this.m.placeholder="title...";J(this.A,"space");this.C=J(this.A,"save");this.T=J(this.A,navigator.canShare?"share":"copy");this.ka=J(this.I,"create");this.S=K(this.I,"a","","about");this.S.setAttribute("href","https://github.com/nicopowa/snippets");this.S.setAttribute("target","_blank");this.V=J(this.I,"export");this.ca=J(this.I,"import");this.s=J(null,"cmds");this.pa=J(this.s,"version");let a=J(this.s,"cmd","delete");J(a,"del-space");J(a,"cmd",
"del-no");this.Y=new Map;this.H.forEach(b=>this.Y.set(b,J(this.content,"lwrap")));ba(this);ca(this);"serviceWorker"in navigator&&navigator.serviceWorker.register("js/snippets.package-service.release.min.js");Q(this)}la(){V(this.W,"hide");this.ja.scrollTop=0}N(){L(this.W,"hide")}U(){this.N();R(this);S(this)}async X(){if(this.g){var a=this.j.find(b=>b.i===this.g);a&&(this.o++,a.t=this.m.value,a.v=this.o,I("[href='#"+this.g+"']",this.M).innerHTML=a.t)}else this.g=Date.now().toString(36)+Math.random().toString(36).slice(2),
this.o=0,a={i:this.g,v:this.o,t:this.m.value},this.j.push(a),M(this,a),V(this.C,"no"),this.content.appendChild(this.s),la(this.g);window.localStorage.setItem("snippet-"+this.g,await Y(this,{i:this.g,v:this.o}));X(this);W(this);T();Z(this.C)}async ga(){let a=location.origin+location.pathname+"#"+await Y(this);navigator.canShare?navigator.share({title:this.m.value,url:a}):navigator.clipboard&&navigator.clipboard.writeText(a).then(()=>Z(this.T))}ha(){let a=this.j.reduce((c,d)=>{d=d.i;c[d]=window.localStorage.getItem("snippet-"+
d)||"";return c},{[this.D]:this.j}),b=document.createElement("a");b.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a)));b.setAttribute("download",this.D+".json");b.style.display="none";document.body.appendChild(b);b.click();b.remove();Z(this.V)}ia(){let a=document.createElement("input");a.type="file";a.accept="application/json";a.style.display="none";document.body.appendChild(a);a.addEventListener("change",()=>{if(a.files.length){let b=a.files[0],c=new FileReader;
c.addEventListener("loadend",d=>{try{let e=JSON.parse(d.target.result);e.snippets.filter(f=>e[f.i]).forEach(f=>{let g=this.j.find(n=>n.i===f.i);if(g&&g.v>g.v||!g)window.localStorage.setItem("snippet-"+f.i,e[f.i]),M(this,f),this.j.push(f),X(this)})}catch(e){}});c.readAsText(b)}a.remove()});a.click()}};}).call(this);
