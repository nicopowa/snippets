/**
 * Nico Pr â€” https://nicopr.fr
 * SNIPPETS PACKAGE RELEASE v0.2.9
 * 01/12/2024 01:14:53
 */
(function(){
var g=this||self;function l(a){a=a.split(".");var b=g;a[0]in b||"undefined"==typeof b.execScript||b.execScript("var "+a[0]);for(var c;a.length&&(c=a.shift());)a.length?b[c]&&b[c]!==Object.prototype[c]?b=b[c]:b=b[c]={}:b[c]=!1};l("DEBUG");l("STAND");function m(a,b,...c){a=document.createElement(a);c.length&&n(a,...c);b&&b.appendChild(a);return a}function n(a,...b){a.classList.add(...b)}function p(a,...b){a.classList.remove(...b)}function q(a,...b){b.forEach(c=>a.classList.toggle(c))}
function aa(){const a=(...b)=>b.map(c=>JSON.stringify(c,(d,e)=>{if(!e)return String(e);if("function"===typeof e)return e.toString();if(e instanceof ErrorEvent)return JSON.stringify(Object.getOwnPropertyNames(Object.getPrototypeOf(e)).reduce((f,h)=>({...f,[h]:e[h]}),{}),null,"\t");if(e instanceof Error)return e.toString();if(e instanceof PromiseRejectionEvent)return e.reason.toString();if(e instanceof Element)return(new XMLSerializer).serializeToString(e).replace(/\sxmlns="[^"]+"/,"");if(e instanceof
Map){let f={};e.forEach((h,k)=>{f[k.toString()]=h});return JSON.stringify(f)}if(e instanceof Set){let f=[];e.forEach(h=>f.push(h));return JSON.stringify(f).replace(/^\[/,"{").replace(/\]$/,"}")}return"object"===typeof e?JSON.stringify(e):e},"\t"));["log","warn","error","evt","perf"].forEach(b=>{console[b]=(...c)=>{window.parent.postMessage([...a(b,...c)],"{o}")}});window.addEventListener("unhandledrejection",b=>console.error(b));window.addEventListener("error",b=>console.error(b))}
function ba(){window.addEventListener("load",async()=>{pre();let a=performance.now(),b=0,c=()=>{js()};for(;1E3>=performance.now()-a;)c(),b++;post();console.perf(b)})}function ca(){window.addEventListener("load",async()=>{console.evt("load");try{pre(),js(),post()}catch(a){console.error(a)}})}function da(a){let b=t.find(c=>c.G&&c.G.contentWindow===a.source);b&&b.$.apply(b,a.data.map(c=>JSON.parse(c)))}
function u(a){var b=t.findIndex(c=>c.M===a);-1!==b&&(b=t.splice(b,1)[0],b.j&&b.j.remove(),b=null)}function v(a,b,c,d){var e=w;a.addEventListener(b,f=>c.bind(e)(f),d)}function y(a){let b="calc("+a.T+"rem + 0.5rem)";var c=a.m;c.style.minHeight=c.style.maxHeight=c.style.height=b;a=a.l;a.style.minHeight=a.style.maxHeight=a.style.height=b}function z(a){a.A?document.fullscreenElement?document.exitFullscreen():a.j.requestFullscreen():q(a.j,"full","force")}
function A(a){clearTimeout(a.B);a.ma();if(!a.g.length)for(;a.h.firstChild;)a.h.removeChild(a.h.lastChild);let b=a.ja.map(c=>t.find(d=>(d.I===c||"#"+d.M===c)&&d.M!=a.M)).filter(Boolean).reduce((c,d)=>{/^p/.test(d.J)?c[d.J]+=d.H+"\n":c[d.S]+=d.H+"\n";return c},{html:"",css:"",js:"",pre:"",post:""});b[a.S]+=a.H;a.m.removeChild(a.G);a.G.srcdoc=ea(a,b);a.m.appendChild(a.G);p(a.j,"err");n(a.o.firstChild,"ing")}
function ea(a,b){let c=/^[^{]+\{([\s\S]+)\}$/g,d=e=>'onerror="console.error(new URIError(event.target.'+e+'));"';return['<html>\n<head>\n<meta http-equiv="content-type" content="text/html; charset=UTF-8">\n<style>\nhtml,body{margin:0;padding:0;width:100%;}\nhtml{height:100%;}\nbody{position:absolute;height:100%;min-height:100%;}',b.css,"</style>",...a.ga.map(e=>'<link rel="stylesheet" href="'+e+'" '+d("href")+"/>"),"<script>",aa.toString().replace(c,"$1").replace(/\{o\}/g,location.origin),"\x3c/script>",
...a.ia.map(e=>'<script src="'+e+'" '+d("src")+">\x3c/script>"),...a.ka.map(e=>'<script type="module" src="'+e+'" '+d("src")+">\x3c/script>"),"<script"+(a.la?' type="module"':"")+">",a.ha.map(e=>"import "+e).join("\n"),("perf"===a.J?ba:ca).toString().replace(c,"$1").replace(/(pre|js|post)\(\);?,?/g,(e,f)=>"\n"+b[f].replace(/(console[^)]+\);?)/g,(h,k)=>"perf"===a.J?"":k)+"\n"),"\x3c/script>\n</head>\n<body>",b.html,"</body>\n</html>"].join("\n")}
function fa(a,b){a.g.push(b);a.$("log",a.g.length+".",Math.round(b),"ops");9>a.g.length?setTimeout(()=>A(a),5):(a.g.sort((c,d)=>c-d),a.$("log","ops/s median",Math.round((a.g[a.g.length-1>>1]+a.g[a.g.length>>1])/2),"avg",Math.round(a.g.reduce((c,d)=>c+d,0)/a.g.length)),a.g=[])}function ha(a,b){"load"===b&&(a.B=setTimeout(()=>p(a.o.firstChild,"ing"),1E3))}
function ia(a,b,...c){let d=new Date,e=m("span",a.h,"snip-"+b);e.setAttribute("data-time",(new Date(d-6E4*d.getTimezoneOffset())).toISOString().slice(-13,-1));for(e.textContent=c.join(" ");128<a.h.childElementCount;)a.h.firstChild.remove();a.l.scrollTo(0,a.l.scrollHeight);"error"==b&&a.j.classList.contains("nolog")&&n(a.j,"err")}
class w{constructor(a,b=0){this.D=a;this.M=b||++B;this.fa=()=>this.D.innerText.replace(/\u200B/g,"");if(b=JSON.parse(decodeURI(a.getAttribute("data-snip")||(/(\{[^}]+\})/.exec(this.H.split("\n",1)[0])||[0]).pop())))this.I=b.name||"",this.S=/language-(\w+)/.exec(a.className)[1].replace(/j.+t/,"js"),this.J=b.hasOwnProperty("type")?b.type:"run",this.B=-1,this.ma=()=>{},this.ja=b.link||[],this.ga=b.css||[],this.ia=b.js||[],this.ka=b.mod||[],this.la=!0===b.module,this.ha=[],this.g=[],this.A=!0,this.C=
null,["run","perf"].includes(this.J)&&(this.j=m("div",null,"snip"),!1!==b.insert&&a.parentNode.after(this.j),this.o=m("span",this.j),v(this.o,"click",c=>{c=c.target;switch([...c.parentNode.children].indexOf(c)){case 0:A(this);break;case 1:z(this);break;case 2:q(this.j,"noone");break;case 3:q(this.j,"nolog");p(this.j,"err");break;case 4:this.T--;y(this);break;case 5:this.T++,y(this)}}),Array(6).fill(0).forEach(()=>m("div",this.o)),this.s=m("div",this.j),this.m=m("div",this.s),n(this.m,"frame"),this.G=
m("iframe",this.m),this.G.sandbox="allow-scripts",this.G.allow="camera;microphone",this.l=m("div",this.s),n(this.l,"cons"),this.h=m("div",this.l),!1===b.body&&n(this.j,"noone"),!1===b.console&&n(this.j,"nolog"),a=m("a",this.s),a.href="//code.nicopowa.com",a.target="_blank",this.T=+(b.height||12),y(this),document.fullscreenEnabled?v(this.j,"fullscreenchange",()=>(document.fullscreenElement?n:p).apply(w,[this.j,"full"])):(this.A=!1,this.C=m("span",this.j,"back"),v(this.C,"click",()=>z(this)))),t.push(this)}$(...a){let b=
a.shift();"perf"===b?fa(this,+a[0]):"evt"===b?ha(this,...a):ia(this,b,...a)}get id(){return this.M}get na(){return this.j}get frame(){return this.G}get size(){return this.T}get H(){return this.fa()}set F(a){this.fa=a}set Ka(a){this.ma=a}set module(a){this.la=a}set u(a){this.ia=a}set links(a){this.ja=a}set Ga(a){this.ka=a}set imports(a){this.ha=a}set Oa(a){this.ga=a}}var B,t;B=0;t=[];v(window,"message",a=>da(a),!1);function D(a,...b){a.classList.add(...b)}function E(a,b=document.body){return b.querySelector(a)}function F(a,...b){return G(a,"div","",...b)}function ja(a){a.l=JSON.parse(window.localStorage.getItem(a.I)||"[]");a.l.forEach(b=>H(a,b))}
function ka(a){I(a,a.oa,a.Da);I(a,a.ta,a.O);I(a,a.Ba,a.O);I(a,a.L,b=>{"Escape"===b.key&&(a.L.value="",a.ca())},"keyup");I(a,a.L,a.ca,"input");I(a,document,b=>{(b.ctrlKey||b.metaKey)&&"rs".includes(b.key)&&(b.preventDefault(),"s"===b.key?a.ea(b):"r"===b.key&&A(a.g.js[0]))},"keydown");[a.B,a.F,a.C,a.K].forEach(b=>I(a,b,c=>c.target.classList.contains("cmd")&&J(a,c.target)));window.addEventListener("hashchange",()=>K(a),!1)}function K(a){a.O();L(a);la(a).then(b=>M(a,b))}
function I(a,b,c,d="click"){b.addEventListener(d,e=>c.bind(a)(e))}function J(a,b){let c=Object.keys(a.aa).find(d=>b.classList.contains(d));c&&a.aa[c].bind(a)(b)}function L(a){a.h&&ma(a);a.h=a.m.innerHTML=document.title="";Object.keys(a.g).forEach(b=>{a.g[b].forEach(c=>{u(c.id)});a.g[b]=[];a.o[b].forEach(c=>{c.destroy()});a.o[b]=[];a.u[b].forEach(c=>{c.remove()});a.u[b]=[]})}function la(a){let b=location.hash.slice(1);return 20>=b.length?na(a,b):N(b)}
function M(a,b){window.scroll(0,0);b||(b={},O());a.m.innerHTML=document.title=b.t||"untitled";a.s=b.v||0;a.Y={...a.Ia,...("string"===typeof b.r?JSON.parse(b.r||"{}"):b.r)};a.D.forEach(d=>{a.g[d]=[];a.X[d]=[];a.u[d]=[];a.o[d]=[];Array.isArray(b[d])||(b[d]=[b[d]]);let e=a.Z.get(d);b[d].forEach((f,h)=>{P(a,d,"js"!==d||h?{name:d+"-"+h,type:""}:a.Y,f,e.firstChild)})});let c=a.g.js[0];a.A.insertBefore(c.na,a.A.firstChild);c.frame.title=a.m.textContent;c.Ka=()=>oa(a);a.h?(Q(a),R(a.V,"no"),a.R()):(Object.keys(b).length||
O(),S(a));T(a);a.D.slice(-3).flatMap(d=>a.g[d].map(e=>e.H.length)).some(d=>0<d)&&A(a.g.js[0])}async function na(a,b){return a.l.some(c=>c.i===b)?(a.h=b,await N(window.localStorage.getItem("snippet-"+b)||"")):null}async function N(a){try{let b=(await pa(a)).trim();return b.startsWith("md=")||b.startsWith("html=")?Object.fromEntries(new URLSearchParams(b)):JSON.parse(b)}catch(b){return console.error(b),null}}
async function pa(a){return await (new Response((new Response(Uint8Array.from(atob(a),b=>b.charCodeAt(0)))).body.pipeThrough(new DecompressionStream("gzip")))).text()}function O(){history.pushState("",document.title,window.location.pathname+window.location.search)}
function P(a,b,c,d,e){var f=F(e,"bloc");e=F(f,"chead");var h=F(e);h=G(h,"div",c.name||"no name","cmd","nnm");var k=F(e);k=F(k,"cmd","tog");let r=G(f,"div","","code","language-"+b);U(r,"data-snip",encodeURI(JSON.stringify(c)));a.u[b].push(f);let C=qa(r,d);a.o[b].push(C);d=new w(r);d.F=()=>C.state.doc.toString();a.g[b].push(d);a.X[b].push(c);U(h,{lang:b,snip:d.id});U(k,{lang:b,snip:d.id});c=F(f,"ctool");f=F(c);f=F(f,"cmd","add");U(f,"lang",b);f=F(c,"rem");U(f,{lang:b,snip:d.id});F(f,"cmd","rem-ask");
F(f,"cmd","rem-yes");F(f,"cmd","rem-no");[e,c].forEach(x=>I(a,x,W=>W.target.classList.contains("cmd")&&J(a,W.target)))}function oa(a){a.A.classList.contains("stick")||window.scroll(0,0);ra(a);let b=a.D.map(c=>a.g[c].map(d=>"#"+d.id));b[b.length-1].reverse();a.g.js[0].links=b.flat()}function Q(a){D(a.C,"store");D(a.K,"store")}function R(a,...b){a.classList.remove(...b)}function S(a){D(a.V,"no")}
function T(a){document.title=a.m.textContent;a.Na.innerHTML="v"+Math.floor(a.s/100)+"."+a.s.toString().padStart(3,"0").slice(-2).split("").join(".");a.Ja.innerHTML=sa(a.D.map(b=>a.g[b].map(c=>c.H.length)).flat().reduce((b,c)=>b+c,0))}function ma(a){R(a.C,"store");R(a.K,"store")}function G(a,b,c,...d){b=document.createElement(b);c&&(b.innerHTML=c);D(b,...d);a&&a.appendChild(b);return b}function U(a,b,c=""){"string"===typeof b&&(b={[b]:c});Object.keys(b).forEach(d=>a.setAttribute(d,b[d]))}
function qa(a,b){let c=/language-(\w+)/g.exec(a.className)[1];return Mirror.reflect(a,c,b,c)}function ta(a,b,c){u(a.g[b][c].id);a.o[b][c].destroy();a.o[b][c]=null;a.u[b][c].remove();a.u[b][c]=null;[a.g,a.o,a.X,a.u].forEach(d=>d[b].splice(c,1));S(a)}
function ra(a){var b={js:[],module:[],[a.W]:[],css:[]};b=Object.keys(b).reduce((d,e)=>{e=new RegExp("^@("+e+")\\s(.+)$","gm");a.g.md.length&&Array.from(a.g.md[0].H.matchAll(e)).forEach(f=>d[f[1]].push(f[2]));return d},b);let c=a.g.js[0];Object.assign(c,{u:b.js,Oa:b.css,Ga:b.module,imports:b[a.W]});b.module.length+b[a.W].length&&(c.module=!0)}
function ua(a,b=""){let [c,d,e]=V("");return new Promise(f=>{const h=(x="")=>{c.remove();f(x)};let k=G(d,"input","","asktext"),r=F(e,"popno"),C=F(e,"popok");k.value=b;I(a,k,x=>{13===x.which?h(k.value):27===x.which&&h()},"keyup");I(a,r,()=>h());I(a,C,()=>h(k.value));k.focus()})}function va(a=document.body){return Array.from(a.querySelectorAll(".menuitem"))}function V(a){let b=F(document.body,"popwrap"),c=F(b,"popmod"),d=F(c,"popcnt");a&&G(d,"div",a,"popwhat");a=F(c,"popbtns");return[b,d,a]}
function wa(a,b){let [c,,d]=V(b);return new Promise(e=>{const f=(r=!1)=>{c.remove();e(r)};let h=F(d,"popno"),k=F(d,"popgo");I(a,h,()=>f());I(a,k,()=>f(!0));I(a,c,r=>{27===r.which&&f()},"keyup")})}function H(a,b){a=G(a.N,"li","","menuitem");a=G(a,"a",b.t);U(a,"href","#"+b.i)}async function xa(a){return btoa((new Uint8Array(await (new Response((new Response(a)).body.pipeThrough(new CompressionStream("gzip")))).arrayBuffer())).reduce((b,c)=>b+String.fromCharCode(c),""))}
async function X(a,b={}){let c=a.g.js[0],d=c.na;b={...a.D.reduce((e,f)=>({...e,[f]:a.g[f].map(h=>h.H)}),{t:a.m.innerHTML,r:{...a.Y,height:c.size,body:!d.classList.contains("noone"),console:!d.classList.contains("nolog")},...b})};b=JSON.stringify(b);return await xa(b)}function ya(a){history.replaceState(a,"","#"+a)}function sa(a){if(!+a)return"0B";let b=Math.floor(Math.log(a)/Math.log(1024));return`${parseFloat((a/Math.pow(1024,b)).toFixed(2))}${"B KB MB GB TB PB EB ZB YB".split(" ")[b]}`}
function Y(a){window.localStorage.setItem(a.I,JSON.stringify(a.l))}function Z(a){R(a,"no");D(a,"yes");setTimeout(()=>R(a,"yes"),750)}
class za{constructor(){this.I="snippets";this.W="import";this.D=["md","html","css","js"];this.aa={ttl:this.Ca,sav:this.ea,snd:this.wa,"new":this.ba,abt:this.pa,dmp:this.za,imp:this.Aa,nnm:this.ua,tog:this.La,add:this.qa,"rem-ask":this.sa,["rem-yes"]:this.Fa,["rem-no"]:this.Ha,"del-ask":this.ra,["del-yes"]:this.xa,["del-no"]:this.R,pin:this.Ea,ver:this.Ma};this.Ia={name:"js",type:"run",height:18,body:!0,console:!0,insert:!1,js:[],css:[]};this.h="";this.s=0;this.Y={};this.X={};this.u={};this.g={};this.o=
{};this.l=[];(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&D(document.body,"stand");this.B=E(".header");this.U=E(".content");this.da=E(".menu");this.F=E(".menutools");this.L=E(".menulook");this.L.placeholder="search...";this.N=E(".menulist");this.oa=F(this.B,"menubtn","none");this.ta=F(this.F,"closebtn");this.Ba=E(".menumask");this.m=F(this.B,"cmd","ttl");F(this.B,"spc");this.V=F(this.B,"cmd","sav");this.va=F(this.B,"cmd","snd");this.A=F(this.U,"wrap");this.C=
F(this.A,"cmds","high");var a=F(this.C);F(a,"cmd","pin");a=F(this.C);this.Na=F(a,"cmd","ver");a=F(this.C);this.Ja=F(a,"cmd","siz");F(this.F,"cmd","new");F(this.F,"cmd","abt");this.ya=F(this.F,"cmd","dmp");F(this.F,"cmd","imp");this.Z=new Map;this.D.forEach(b=>{let c=F(this.U,"lwrap");F(c,"lcode");F(c,"ltool");this.Z.set(b,c)});this.K=F(this.U,"cmds","down");this.P=F(this.K,"del");F(this.P,"cmd","del-ask");F(this.P,"cmd","del-no");F(this.P,"cmd","del-yes");F(this.K,"spc");ja(this);ka(this);"serviceWorker"in
navigator&&navigator.serviceWorker.register("js/snippets.package-service.release.min.js",{});K(this)}Ca(){let a=this.m.innerHTML;ua(this,a).then(b=>{b&&b!==a&&(this.m.innerHTML=b,S(this))})}Da(){R(this.da,"none")}O(){D(this.da,"none")}ca(){let a=this.L.value;va(this.N).forEach(b=>{var c=a&&!b.textContent.includes(a);b.classList.toggle("hide",c)})}ba(){this.O();L(this);O();M(this)}pa(){window.open("https://github.com/nicopowa/snippets","_blank")}async ea(){if(this.h){var a=this.l.find(b=>b.i===this.h);
a&&(this.s++,a.t=this.m.innerHTML,a.v=this.s,E("[href='#"+this.h+"']",this.N).innerHTML=a.t)}else this.h=Date.now().toString(36)+Math.random().toString(36).slice(2),this.s=0,a={i:this.h,v:this.s,t:this.m.innerHTML},this.l.push(a),H(this,a),Q(this),ya(this.h);window.localStorage.setItem("snippet-"+this.h,await X(this,{i:this.h,v:this.s}));Y(this);T(this);this.R();Z(this.V)}ua(a){let b=a.getAttribute("snip");a=a.getAttribute("lang");let c=this.g[a].findIndex(d=>d.id==b);a=this.u[a][c];a.classList.contains("clps")&&
R(a,"clps")}La(a){let b=a.getAttribute("snip");a=a.getAttribute("lang");let c=this.g[a].findIndex(d=>d.id==b);a=this.u[a][c];a.classList.toggle("clps",void 0);R(E(".rem",a),"ask")}qa(a){a=a.getAttribute("lang");P(this,a,{name:a+"-"+this.o[a].length,type:""},"",this.Z.get(a).firstChild);S(this)}sa(a){D(a.parentElement,"ask")}Fa(a){a=a.parentNode;let b=a.getAttribute("snip");a=a.getAttribute("lang");let c=this.g[a].findIndex(d=>d.id==b);ta(this,a,c);S(this)}Ha(a){R(a.parentElement,"ask")}ra(a){D(a.parentElement,
"ask")}xa(){wa(this,'delete "'+this.m.textContent+'" ?').then(a=>{this.R();a&&(this.l.splice(this.l.findIndex(b=>b.i===this.h),1),Y(this),E("[href='#"+this.h+"']",this.N).parentNode.remove(),window.localStorage.removeItem("snippet-"+this.h),this.ba())})}R(){R(this.P,"ask")}Ea(){this.A.classList.contains("stick")?R(this.A,"stick"):D(this.A,"stick")}Ma(){}async wa(){let a=location.origin+location.pathname+"#"+await X(this);navigator.canShare?navigator.share({title:this.m.textContent,url:a}):navigator.clipboard&&
navigator.clipboard.writeText(a).then(()=>Z(this.va))}za(){let a=this.l.reduce((c,d)=>{d=d.i;c[d]=window.localStorage.getItem("snippet-"+d)||"";return c},{[this.I]:this.l}),b=document.createElement("a");U(b,{href:"data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a)),download:this.I+".json"});b.style.display="none";document.body.appendChild(b);b.click();b.remove();Z(this.ya)}Aa(){let a=document.createElement("input");a.type="file";a.accept="application/json";a.style.display=
"none";document.body.appendChild(a);a.addEventListener("change",()=>{if(a.files.length){let b=a.files[0],c=new FileReader;c.addEventListener("loadend",d=>{try{let e=JSON.parse(d.target.result);e.snippets.filter(f=>e[f.i]).forEach(f=>{let h=this.l.find(k=>k.i===f.i);if(h&&h.v>h.v||!h)window.localStorage.setItem("snippet-"+f.i,e[f.i]),H(this,f),this.l.push(f),Y(this)})}catch(e){}});c.readAsText(b)}a.remove()});a.click()}};window.addEventListener("load",()=>new za);}).call(this);
