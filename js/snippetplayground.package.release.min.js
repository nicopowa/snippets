/**
 * snippetplayground package release
 * Â© ILUSIO 2024 https://snipp.et
 * The Closure Library Authors - Apache-2.0
 */
(function(){
var f=this||self;function k(a,b){a=a.split(".");var c=f;a[0]in c||"undefined"==typeof c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!==Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b};k("DEBUG",!1);k("STAND",!1);function l(a){if(!a.g.length)for(;a.l.firstChild;)a.l.removeChild(a.l.lastChild);let b=m.g.filter(c=>a.s.includes(c.ba)||a.s.includes("#"+c.D)).reduce((c,d)=>{/^p/.test(d.u)?c[d.u]+=d.G+"\n":c[d.F]+=d.G+"\n";return c},{html:"",css:"",js:"",pre:"",post:""});b[a.F]+=a.G;a.h.removeChild(a.o);a.o.srcdoc=n(a,b);a.h.insertBefore(a.o,a.j)}
function n(a,b){let c=/^[^{]+\{([\s\S]+)\}$/g,d=e=>'onerror="console.error(new URIError(event.target.'+e+'));"';return['<html>\n<head>\n<meta http-equiv="content-type" content="text/html; charset=UTF-8">\n<style>\nhtml,body{margin:0;padding:0;width:100%;height:100%;}',b.css,"</style>",...a.v.map(e=>'<link rel="stylesheet" href="'+e+'" '+d("href")+"/>"),"<script>",m.j.toString().replace(c,"$1").replace("{o}",location.origin),"\x3c/script>",...a.B.map(e=>'<script src="'+e+'" '+d("src")+">\x3c/script>"),
"<script"+(a.C?' type="module"':"")+">",("perf"===a.u?m.l:m.m).toString().replace(c,"$1").replace(/(pre|js|post)\(\);?,?/g,(e,g)=>"\n"+b[g].replace(/(console[^)]+\);?)/g,(h,p)=>"perf"===a.u?"":p)+"\n"),"\x3c/script>\n</head>\n<body>",b.html,"</body>\n</html>"].join("\n")}
function q(a,b){a.g.push(b);a.M("log",a.g.length+".",Math.round(b),"ops");9>a.g.length?setTimeout(()=>l(a),5):(a.g.sort((c,d)=>c-d),a.M("log","ops/s median",Math.round((a.g[a.g.length-1>>1]+a.g[a.g.length>>1])/2),"avg",Math.round(a.g.reduce((c,d)=>c+d,0)/a.g.length)),a.g=[])}function r(a){let b=m.g.find(c=>c.o&&c.o.contentWindow===a.source);b&&b.M.apply(b,a.data.map(c=>JSON.parse(c)))}
class m{constructor(a,b=0){this.aa=a;this.D=b||++m.D;if(b=JSON.parse(decodeURI(a.getAttribute("data-snip")||(/(\{[^}]+\})/.exec(this.G.split("\n",1)[0])||[0]).pop()))){this.ba=b.name||"";this.F=/language-(\w+)/.exec(a.className)[1].replace(/j.+t/,"js");this.u=b.hasOwnProperty("type")?b.type:"run";this.C=b.module||!1;this.s=b.link||[];this.v=b.css||[];this.B=b.js||[];this.g=[];if("run"==this.u||"perf"==this.u)this.h=document.createElement("div"),this.h.className+=" snip",a=a.parentNode,!1!==b.insert&&
a.parentNode.insertBefore(this.h,a.nextSibling),this.m=document.createElement("span"),this.h.appendChild(this.m),a=document.createElement("button"),this.m.appendChild(a),a.addEventListener("click",()=>l(this)),b.full&&document.fullscreenEnabled&&(a=document.createElement("button"),this.m.appendChild(a),a.addEventListener("click",()=>{document.fullscreenElement?document.exitFullscreen():this.h.requestFullscreen()}),this.h.addEventListener("fullscreenchange",()=>{[this.m,this.o].map(c=>c.classList).forEach(c=>
document.fullscreenElement?c.add("full"):c.remove("full"));l(this)})),a=document.createElement("a"),a.setAttribute("href","//snipp.et"),a.setAttribute("target","_blank"),this.m.appendChild(a),this.o=document.createElement("iframe"),this.o.setAttribute("sandbox","allow-scripts"),this.h.appendChild(this.o),this.j=document.createElement("div"),this.h.appendChild(this.j),this.l=document.createElement("div"),this.j.appendChild(this.l),!1===b.body&&(this.h.className+=" snip-nobody"),!1===b.console&&(this.h.className+=
" snip-noconsole"),b=/(\d+)(\w+)?/.exec(b.height||12),this.A="calc("+(b[2]?b.slice(1).join(""):b[1]+"em")+" + 0.5em)",this.o.style.height=this.j.style.minHeight=this.j.style.maxHeight=this.A;m.g.push(this)}}M(...a){let b=a.shift();if("perf"==b)return q(this,+a[0]);let c=new Date,d=document.createElement("span");d.className+=" snip-"+b;d.setAttribute("data-time",(new Date(c-6E4*c.getTimezoneOffset())).toISOString().slice(-13,-1));d.textContent=a.join(" ");this.l.appendChild(d);this.j.scrollTo(0,this.j.scrollHeight)}get id(){return this.D}get U(){return this.h}get G(){return this.aa.innerText.replace(/\u200B/g,
"")}static remove(a){var b=m.g.findIndex(c=>c.D===a);-1!==b&&(b=m.g.splice(b,1)[0],b.h&&b.h.remove(),b=null)}static j(){const a=(...b)=>b.map(c=>JSON.stringify(c,(d,e)=>{if(!e)return String(e);if("function"===typeof e)return e.toString();if(e instanceof ErrorEvent)return JSON.stringify(Object.getOwnPropertyNames(Object.getPrototypeOf(e)).reduce((g,h)=>({...g,[h]:e[h]}),{}),null,"\t");if(e instanceof Error)return e.toString();if(e instanceof PromiseRejectionEvent)return e.reason.toString();if(e instanceof
Element)return(new XMLSerializer).serializeToString(e).replace(/\sxmlns="[^"]+"/,"");if(e instanceof Map){let g={};e.forEach((h,p)=>{g[p.toString()]=h});return JSON.stringify(g)}if(e instanceof Set){let g=[];e.forEach(h=>g.push(h));return JSON.stringify(g).replace(/^\[/,"{").replace(/\]$/,"}")}return"object"===typeof e?JSON.stringify(e):e},"\t"));["log","warn","error","perf"].forEach(b=>{console[b]=(...c)=>{window.parent.postMessage([...a(b,...c)],"{o}")}});window.addEventListener("unhandledrejection",
b=>console.error(b));window.addEventListener("error",b=>console.error(b))}static m(){window.addEventListener("load",async()=>{try{pre(),js(),post()}catch(a){console.error(a)}})}static l(){window.addEventListener("load",async()=>{pre();let a=performance.now(),b=0,c=()=>{js()};for(;1E3>=performance.now()-a;)c(),b++;post();console.perf(b)})}}k("Snippet",m);m.D=0;m.g=[];window.addEventListener("message",a=>r(a),!1);window.addEventListener("load",()=>new t);function u(a,...b){let c=document.createElement("div");c.classList.add(...b);a&&a.appendChild(c);return c}
function v(a){a.I.addEventListener("click",()=>w(a));a.K.addEventListener("click",b=>"A"===b.target.nodeName&&w(a)&&x(a,b.target.href));a.B.addEventListener("click",b=>b.target.classList.contains("opt")&&y(a,b.target));a.l.addEventListener("click",b=>b.target.classList.contains("cmd")&&z(a,b.target));(new Map([[a.create,a.P],[a.V,a.W],[a.N,a.S],[a.O,a.Y]])).forEach((b,c)=>c.addEventListener("click",()=>b.bind(a)()));document.addEventListener("keydown",b=>{(b.ctrlKey||b.metaKey)&&"rs".includes(b.key)&&
(b.preventDefault(),"s"===b.key?a.S():"r"===b.key&&(window.scroll(0,0),l(a.s.js)))})}function A(a){a.store=JSON.parse(window.localStorage.getItem("snippets")||"[]");a.store.forEach(b=>B(a,b))}async function C(a,b){return a.store.find(c=>c.i===b)?(a.g=b,await D(window.localStorage.getItem("snippet-"+b))):{}}async function D(a){try{return Object.fromEntries(new URLSearchParams(await E(a).catch(()=>({}))))}catch(b){return console.error(b),{}}}
function F(a,b={}){document.title=a.j.value=b.t||"untitled";a.m={...a.Z,...JSON.parse(b.r||"{}")};a.L.forEach(c=>{let d=a.B.querySelector("."+c).classList;a.m[c]?d.add("on"):d.remove("on")});a.v.appendChild(a.B);["html","css"].forEach(c=>G(a,c,JSON.stringify({name:c,type:""}),b[c]||""));G(a,"js",JSON.stringify(a.m),b.js||"");a.$.appendChild(a.s.js.U);a.g&&(a.v.appendChild(a.l),a.l.firstChild.classList.remove("del-yes"))}function w(a){[a.K,a.I].forEach(b=>b.classList.toggle("hide"));return!0}
async function x(a,b){b=b.slice(b.lastIndexOf("#")+1);H(a);F(a,await C(a,b))}function y(a,b){let c=a.L.find(d=>b.classList.contains(d));a.m[c]=!a.m[c];b.classList.toggle("on");a.s.js.U.classList.toggle("snip-no"+c)}function z(a,b){switch(a.X.find(c=>b.classList.contains(c))){case "delete":b.classList.add("del-yes");break;case "del-yes":I(a);break;case "del-no":b.parentNode.classList.remove("del-yes")}}
async function E(a){return await (new Response((new Response(Uint8Array.from(atob(a),b=>b.charCodeAt(0)))).body.pipeThrough(new DecompressionStream("gzip")))).text()}
function G(a,b,c,d){let e=document.createElement("div");e.classList.add("code");a.v.appendChild(e);let g=document.createElement("pre");g.classList.add("prism-live","line-numbers");e.appendChild(g);let h=document.createElement("code");h.classList.add("code","language-"+b);h.setAttribute("data-snip",encodeURI(c));h.textContent=d;g.appendChild(h);a.J[b]=e;c=new Prism.Live(g);c.textarea.placeholder=b;a.C[b]=c;a.s[b]=new m(h)}
function H(a){a.g&&a.l.remove();a.g="";a.B.remove();a.R.forEach(b=>{console.log("remove",b);m.remove(a.s[b].id);a.C[b]=null;a.J[b].remove()});a.s={};a.C={};a.J={}}function I(a){a.store.splice(a.store.findIndex(b=>b.i===a.g),1);J(a);a.H.querySelector("[href='#"+a.g+"']").parentNode.remove();window.localStorage.removeItem("snippet-"+a.g);a.P()}function K(a){[a.K,a.I].forEach(b=>b.classList.add("hide"))}
function B(a,b){let c=document.createElement("li");a.H.appendChild(c);a=document.createElement("a");a.setAttribute("href","#"+b.i);a.innerHTML=b.t;c.appendChild(a)}async function L(a){return btoa(String.fromCharCode(...(new Uint8Array(await (new Response((new Response(a)).body.pipeThrough(new CompressionStream("gzip")))).arrayBuffer()))))}function M(a){history.replaceState(a,"","#"+a)}
async function N(a,b=[]){return await L(a.R.map(c=>c+"="+encodeURIComponent(a.C[c].textarea.value)).concat([...b,"t="+encodeURIComponent(a.j.value),"r="+JSON.stringify(a.m)]).join("&"))}function J(a){window.localStorage.setItem("snippets",JSON.stringify(a.store))}function O(a){a.classList.add("yes");setTimeout(()=>a.classList.remove("yes"),500)}
class t{constructor(){this.R=["html","css","js"];this.L=["body","console"];this.X=["del-yes","del-no","delete"];this.Z={name:"js",type:"run",height:"18",body:!0,console:!0,insert:!1,js:[],css:[],link:["html","css"]};this.g="";this.m={};this.J={};this.s={};this.C={};this.store=[];this.A=document.querySelector(".header");this.v=document.querySelector(".content");this.K=document.querySelector(".menu");this.T=document.querySelector(".menutools");this.H=document.querySelector(".menulist");this.I=u(this.A,
"menubtn","hide");this.$=u(this.v,"wrap");this.j=document.createElement("input");this.j.placeholder="title...";this.j.classList.add("title");this.A.appendChild(this.j);u(this.A,"space");this.N=u(this.A,"save");this.O=u(this.A,"copy");this.create=u(this.T,"create");this.V=u(this.T,"about");this.B=u(null,"opts");this.L.forEach(b=>u(this.B,b,"opt"));this.l=u(null,"cmds");let a=u(this.l,"cmd","delete");u(a,"del-space");u(a,"cmd","del-no");v(this);this.start()}async start(){A(this);let a=location.hash.slice(1),
b={};8===a.length?b=await C(this,a):8<a.length&&(b=await D(a));F(this,b)}P(){K(this);H(this);F(this);M("")}async W(){K(this);H(this);F(this,await D(await (await fetch("about.snippet")).text()));M("")}async S(){if(this.g){var a=this.store.find(b=>b.i===this.g);if(a){a.t=this.j.value;let b=this.H.querySelector("[href='#"+this.g+"']");b&&(b.innerHTML=a.t)}}else a={i:Date.now().toString(36),t:this.j.value},this.g=a.i,document.title=a.t,this.store.push(a),B(this,a),this.v.appendChild(this.l),M(a.i);window.localStorage.setItem("snippet-"+
this.g,await N(this,["i="+this.g]));J(this);O(this.N)}async Y(){await navigator.clipboard.writeText(location.origin+location.pathname+"#"+await N(this));O(this.O)}};}).call(this);
