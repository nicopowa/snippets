/**
 * snippetplayground package release
 * Â© ILUSIO 2024 https://snipp.et
 * The Closure Library Authors - Apache-2.0
 */
(function(){
var h=this||self;function k(a){a=a.split(".");var b=h;a[0]in b||"undefined"==typeof b.execScript||b.execScript("var "+a[0]);for(var c;a.length&&(c=a.shift());)a.length?b[c]&&b[c]!==Object.prototype[c]?b=b[c]:b=b[c]={}:b[c]=!1};k("DEBUG");k("STAND");function l(){const a=(...b)=>b.map(c=>JSON.stringify(c,(e,d)=>{if(!d)return String(d);if("function"===typeof d)return d.toString();if(d instanceof ErrorEvent)return JSON.stringify(Object.getOwnPropertyNames(Object.getPrototypeOf(d)).reduce((f,g)=>({...f,[g]:d[g]}),{}),null,"\t");if(d instanceof Error)return d.toString();if(d instanceof PromiseRejectionEvent)return d.reason.toString();if(d instanceof Element)return(new XMLSerializer).serializeToString(d).replace(/\sxmlns="[^"]+"/,"");if(d instanceof
Map){let f={};d.forEach((g,n)=>{f[n.toString()]=g});return JSON.stringify(f)}if(d instanceof Set){let f=[];d.forEach(g=>f.push(g));return JSON.stringify(f).replace(/^\[/,"{").replace(/\]$/,"}")}return"object"===typeof d?JSON.stringify(d):d},"\t"));["log","warn","error","perf"].forEach(b=>{console[b]=(...c)=>{window.parent.postMessage([...a(b,...c)],"{o}")}});window.addEventListener("unhandledrejection",b=>console.error(b));window.addEventListener("error",b=>console.error(b))}
function m(){window.addEventListener("load",async()=>{pre();let a=performance.now(),b=0,c=()=>{js()};for(;1E3>=performance.now()-a;)c(),b++;post();console.perf(b)})}function p(){window.addEventListener("load",async()=>{try{pre(),js(),post()}catch(a){console.error(a)}})}function q(a){let b=r.find(c=>c.u&&c.u.contentWindow===a.source);b&&b.S.apply(b,a.data.map(c=>JSON.parse(c)))}function t(a){var b=r.findIndex(c=>c.T===a);-1!==b&&(b=r.splice(b,1)[0],b.o&&b.o.remove(),b=null)}
function u(a){a.u.style.minHeight=a.j.style.minHeight=a.j.style.maxHeight=a.j.style.height="calc("+a.M+"em + 0.5em)"}function v(a){if(!a.g.length)for(;a.l.firstChild;)a.l.removeChild(a.l.lastChild);let b=r.filter(c=>a.s.includes(c.F)||a.s.includes("#"+c.T)).reduce((c,e)=>{/^p/.test(e.A)?c[e.A]+=e.N+"\n":c[e.L]+=e.N+"\n";return c},{html:"",css:"",js:"",pre:"",post:""});b[a.L]+=a.N;a.m.removeChild(a.u);a.u.srcdoc=w(a,b);a.m.insertBefore(a.u,a.j)}
function w(a,b){let c=/^[^{]+\{([\s\S]+)\}$/g,e=d=>'onerror="console.error(new URIError(event.target.'+d+'));"';return['<html>\n<head>\n<meta http-equiv="content-type" content="text/html; charset=UTF-8">\n<style>\nhtml,body{margin:0;padding:0;width:100%;height:100%;}',b.css,"</style>",...a.aa.map(d=>'<link rel="stylesheet" href="'+d+'" '+e("href")+"/>"),"<script>",l.toString().replace(c,"$1").replace("{o}",location.origin),"\x3c/script>",...a.ba.map(d=>'<script src="'+d+'" '+e("src")+">\x3c/script>"),
"<script"+(a.ca?' type="module"':"")+">",("perf"===a.A?m:p).toString().replace(c,"$1").replace(/(pre|js|post)\(\);?,?/g,(d,f)=>"\n"+b[f].replace(/(console[^)]+\);?)/g,(g,n)=>"perf"===a.A?"":n)+"\n"),"\x3c/script>\n</head>\n<body>",b.html,"</body>\n</html>"].join("\n")}
function x(a,b){a.g.push(b);a.S("log",a.g.length+".",Math.round(b),"ops");9>a.g.length?setTimeout(()=>v(a),5):(a.g.sort((c,e)=>c-e),a.S("log","ops/s median",Math.round((a.g[a.g.length-1>>1]+a.g[a.g.length>>1])/2),"avg",Math.round(a.g.reduce((c,e)=>c+e,0)/a.g.length)),a.g=[])}function y(...a){console.log("keep",a)}
function z(a,b,...c){let e=new Date,d=document.createElement("span");d.classList.add("snip-"+b);d.setAttribute("data-time",(new Date(e-6E4*e.getTimezoneOffset())).toISOString().slice(-13,-1));d.textContent=c.join(" ");a.l.appendChild(d);a.j.scrollTo(0,a.j.scrollHeight)}
class A{constructor(a){this.oa=a;this.T=++B;let b=JSON.parse(decodeURI(a.getAttribute("data-snip")||(/(\{[^}]+\})/.exec(this.N.split("\n",1)[0])||[0]).pop()));if(b){this.F=b.name||"";this.L=/language-(\w+)/.exec(a.className)[1].replace(/j.+t/,"js");this.A=b.hasOwnProperty("type")?b.type:"run";this.ca=b.module||!1;this.s=b.link||[];this.aa=b.css||[];this.ba=b.js||[];this.g=[];if("run"==this.A||"perf"==this.A)this.o=document.createElement("div"),this.o.classList.add("snip"),a=a.parentNode,!1!==b.insert&&
a.parentNode.insertBefore(this.o,a.nextSibling),this.h=document.createElement("span"),this.o.appendChild(this.h),this.h.addEventListener("click",c=>{switch(Array.from(this.h.children).indexOf(c.target)){case 0:v(this);break;case 1:document.fullscreenElement?document.exitFullscreen():this.o.requestFullscreen();break;case 2:this.D.classList.toggle("snip-nobody");break;case 3:this.D.classList.toggle("snip-noconsole");break;case 4:this.M--;u(this);break;case 5:this.M++,u(this)}}),this.h.appendChild(document.createElement("div")),
this.h.appendChild(document.createElement("div")),this.o.addEventListener("fullscreenchange",()=>{document.fullscreenElement?this.D.classList.add("full"):this.D.classList.remove("full")}),this.B=document.createElement("div"),this.h.appendChild(this.B),this.C=document.createElement("div"),this.h.appendChild(this.C),this.h.appendChild(document.createElement("div")),this.h.appendChild(document.createElement("div")),a=document.createElement("a"),a.setAttribute("href","//snipp.et"),a.setAttribute("target",
"_blank"),this.h.appendChild(a),this.m=document.createElement("div"),this.o.appendChild(this.m),this.u=document.createElement("iframe"),this.u.setAttribute("sandbox","allow-scripts"),this.m.appendChild(this.u),this.j=document.createElement("div"),this.m.appendChild(this.j),this.l=document.createElement("div"),this.j.appendChild(this.l),!1===b.body&&this.o.classList.add("snip-nobody"),!1===b.console&&this.o.classList.add("snip-noconsole"),this.M=+(b.height||12),u(this);r.push(this)}}S(...a){let b=
a.shift();"perf"===b?x(this,+a[0]):"keep"===b?y(...a):z(this,b,...a)}get id(){return this.T}get D(){return this.o}get size(){return this.M}get N(){return this.oa.innerText.replace(/\u200B/g,"")}set module(a){this.ca=a}set H(a){this.ba=a}set pa(a){this.aa=a}}var B,r;B=0;r=[];window.addEventListener("message",a=>q(a),!1);window.addEventListener("load",()=>new C);function D(a,b=document){return b.querySelector(a)}function E(a,...b){return F(a,"div","",...b)}function F(a,b,c,...e){b=document.createElement(b);c&&(b.innerHTML=c);G(b,...e);a&&a.appendChild(b);return b}
function H(a){I(a,a.P,a.Z);I(a,a.K,b=>"A"===b.target.nodeName&&a.Z()&&J(a,b.target.href));I(a,a.s,b=>b.target.classList.contains("cmd")&&K(a,b.target));(new Map([[a.ka,a.V],[a.ea,a.fa],[a.B,a.Y],[a.U,a.ha],[a.W,a.ia],[a.na,a.ja]])).forEach((b,c)=>I(a,c,b));I(a,document,b=>{(b.ctrlKey||b.metaKey)&&"rs".includes(b.key)&&(b.preventDefault(),"s"===b.key?a.Y(b):"r"===b.key&&L(a))},"keydown")}async function aa(a){ba(a);var b=location.hash.slice(1);b=18>=b.length?await M(a,b):await N(b);O(a,b)}
function ba(a){a.h=JSON.parse(window.localStorage.getItem(a.F)||"[]");a.h.forEach(b=>P(a,b))}async function M(a,b){return a.h.some(c=>c.i===b)?(a.g=b,await N(window.localStorage.getItem("snippet-"+b))):{}}async function N(a){try{return Object.fromEntries(new URLSearchParams(await ca(a).catch(()=>({}))))}catch(b){return console.error(b),{}}}
function O(a,b={}){document.title=a.l.value=b.t||"untitled";a.j=b.v||0;a.R={...a.la,...JSON.parse(b.r||"{}")};a.J.slice(0,-1).forEach(c=>Q(a,c,{name:c,type:""},b[c]||""));Q(a,"js",a.R,b.js||"");a.ma.appendChild(a.m.js.D);a.g?(a.I.appendChild(a.s),R(a.B,"no"),S()):G(a.B,"no");T(a);L(a)}function I(a,b,c,e="click"){b.addEventListener(e,d=>c.bind(a)(d))}async function J(a,b){b=b.slice(b.lastIndexOf("#")+1);U(a);O(a,await M(a,b))}
function K(a,b){switch(a.ga.find(c=>b.classList.contains(c))){case "delete":G(b,"del-yes");break;case "del-yes":da(a);break;case "del-no":S()}}function L(a){window.scroll(0,0);ea(a);v(a.m.js)}async function ca(a){return await (new Response((new Response(Uint8Array.from(atob(a),b=>b.charCodeAt(0)))).body.pipeThrough(new DecompressionStream("gzip")))).text()}
function Q(a,b,c,e){let d=E(a.I,"code");F(d,"div",b,"lang");let f=F(d,"pre","","prism-live","line-numbers"),g=F(f,"code","","code","language-"+b);g.setAttribute("data-snip",encodeURI(JSON.stringify(c)));g.textContent=e;a.H[b]=d;c=new Prism.Live(f);a.G[b]=c;a.m[b]=new A(g)}function R(a,...b){a.classList.remove(...b)}function S(){R(D(".cmd.delete"),"del-yes")}function G(a,...b){a.classList.add(...b)}
function T(a){document.title=a.l.value;a.da.innerHTML="v"+Math.floor(a.j/100)+"."+a.j.toString().padStart(3,"0").slice(-2).split("").join(".")}function U(a){a.g&&a.s.remove();a.g="";a.J.forEach(b=>{t(a.m[b].id);a.G[b]=null;a.H[b].remove()});a.m={};a.G={};a.H={}}function ea(a){var b={js:[],css:[]};b=Object.keys(b).reduce((e,d)=>{Array.from(a.G.md.textarea.value.matchAll(new RegExp("^@("+d+")\\s(.+)$","gm"))).forEach(f=>e[f[1]].push(f[2]));return e},b);let c=a.m.js;c.H=b.js;c.pa=b.css}
function da(a){a.h.splice(a.h.findIndex(b=>b.i===a.g),1);V(a);D("[href='#"+a.g+"']",a.O).parentNode.remove();window.localStorage.removeItem("snippet-"+a.g);S();a.V()}function fa(a){[a.K,a.P].forEach(b=>R(b,"hide"))}function W(a){[a.K,a.P].forEach(b=>G(b,"hide"))}function P(a,b){a=F(a.O,"li","");F(a,"a",b.t).setAttribute("href","#"+b.i)}
async function ha(a){return btoa(String.fromCharCode(...(new Uint8Array(await (new Response((new Response(a)).body.pipeThrough(new CompressionStream("gzip")))).arrayBuffer()))))}function X(a){history.replaceState(a,"","#"+a)}
async function Y(a,b=[]){var c=a.m.js;let e=!c.D.classList.contains("snip-nobody"),d=!c.D.classList.contains("snip-noconsole");c=c.size;return await ha(a.J.map(f=>f+"="+encodeURIComponent(a.G[f].textarea.value)).concat([...b,"t="+encodeURIComponent(a.l.value),"r="+JSON.stringify({...a.R,height:c,body:e,console:d})]).join("&"))}function V(a){window.localStorage.setItem(a.F,JSON.stringify(a.h))}function Z(a){G(a,"yes");setTimeout(()=>R(a,"yes"),750)}
class C{constructor(){this.F="snippets";this.J=["md","html","css","js"];this.ga=["del-yes","del-no","delete"];this.la={name:"js",type:"run",height:18,body:!0,console:!0,insert:!1,js:[],css:[],link:this.J.slice(1,-1)};this.g="";this.j=0;this.R={};this.H={};this.m={};this.G={};this.h=[];this.C=D(".header");this.I=D(".content");this.K=D(".menu");this.$=D(".menutools");this.X=D(".moretools");this.O=D(".menulist");this.P=E(this.C,"menubtn","hide");this.ma=E(this.I,"wrap");this.l=F(this.C,"input","","snip-title");
this.l.placeholder="title...";E(this.C,"space");this.B=E(this.C,"save");this.U=E(this.C,"copy");this.ka=E(this.$,"create");this.ea=E(this.$,"about");this.W=E(this.X,"down");this.na=E(this.X,"up");this.s=E(null,"cmds");this.da=E(this.s,"vno");let a=E(this.s,"cmd","delete");E(a,"del-space");E(a,"cmd","del-no");H(this);aa(this)}Z(){this.K.classList.contains("hide")?fa(this):W(this);return!0}V(){W(this);U(this);O(this);X("")}async fa(){W(this);U(this);O(this,await N(await (await fetch("about.snippet")).text()));
X("")}async Y(){if(this.g){this.j++;var a=this.h.find(b=>b.i===this.g);a&&(a.t=this.l.value,a.v=this.j,D("[href='#"+this.g+"']",this.O).innerHTML=a.t)}else this.g=Date.now().toString(36)+Math.random().toString(36).slice(2),this.j=0,a={i:this.g,v:this.j,t:this.l.value},this.h.push(a),P(this,a),R(this.B,"no"),this.I.appendChild(this.s),X(this.g);window.localStorage.setItem("snippet-"+this.g,await Y(this,["i="+this.g,"v="+this.j]));V(this);T(this);S();Z(this.B)}async ha(){let a=location.origin+location.pathname+
"#"+await Y(this);navigator.share({title:this.l.value,url:a}).catch(b=>{console.log(b);navigator.clipboard.writeText(a).then(()=>Z(this.U))})}ia(){let a=this.h.reduce((c,e)=>{e=e.i;c[e]=window.localStorage.getItem("snippet-"+e);return c},{[this.F]:this.h}),b=document.createElement("a");b.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a)));b.setAttribute("download",this.F+".json");b.style.display="none";document.body.appendChild(b);b.click();b.remove();
Z(this.W)}ja(){let a=document.createElement("input");a.type="file";a.accept="application/json";a.style.display="none";document.body.appendChild(a);a.addEventListener("change",()=>{if(a.files.length){let b=a.files[0],c=new FileReader;c.addEventListener("loadend",e=>{try{let d=JSON.parse(e.target.result);d.snippets.filter(f=>d[f.i]).forEach(f=>{let g=this.h.find(n=>n.i===f.i);if(g&&g.v>g.v||!g)window.localStorage.setItem("snippet-"+f.i,d[f.i]),P(this,f),this.h.push(f),V(this)})}catch(d){}});c.readAsText(b)}});
a.click()}};}).call(this);
