/**
 * snippetplayground package debug
 * Â© ILUSIO 2024 https://snipp.et
 * The Closure Library Authors - Apache-2.0
 */
(function(){
var h=this||self;function k(a,b){a=a.split(".");var c=h;a[0]in c||"undefined"==typeof c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!==Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b};k("DEBUG",!0);k("STAND",!1);function l(){const a=(...b)=>b.map(c=>JSON.stringify(c,(d,e)=>{if(!e)return String(e);if("function"===typeof e)return e.toString();if(e instanceof ErrorEvent)return JSON.stringify(Object.getOwnPropertyNames(Object.getPrototypeOf(e)).reduce((f,g)=>({...f,[g]:e[g]}),{}),null,"\t");if(e instanceof Error)return e.toString();if(e instanceof PromiseRejectionEvent)return e.reason.toString();if(e instanceof Element)return(new XMLSerializer).serializeToString(e).replace(/\sxmlns="[^"]+"/,"");if(e instanceof
Map){let f={};e.forEach((g,n)=>{f[n.toString()]=g});return JSON.stringify(f)}if(e instanceof Set){let f=[];e.forEach(g=>f.push(g));return JSON.stringify(f).replace(/^\[/,"{").replace(/\]$/,"}")}return"object"===typeof e?JSON.stringify(e):e},"\t"));["log","warn","error","perf"].forEach(b=>{console[b]=(...c)=>{window.parent.postMessage([...a(b,...c)],"{o}")}});window.addEventListener("unhandledrejection",b=>console.error(b));window.addEventListener("error",b=>console.error(b))}
function m(){window.addEventListener("load",async()=>{pre();let a=performance.now(),b=0,c=()=>{js()};for(;1E3>=performance.now()-a;)c(),b++;post();console.perf(b)})}function p(){window.addEventListener("load",async()=>{try{pre(),js(),post()}catch(a){console.error(a)}})}function q(a){console.log(a);let b=r.find(c=>c.u&&c.u.contentWindow===a.source);b&&b.T.apply(b,a.data.map(c=>JSON.parse(c)))}
function t(a){var b=r.findIndex(c=>c.C===a);-1!==b&&(b=r.splice(b,1)[0],console.log("remove snippet",b.C),b.m&&b.m.remove(),b=null)}function u(a){a.u.style.minHeight=a.s.style.minHeight=a.s.style.maxHeight=a.s.style.height="calc("+a.O+"em + 0.5em)"}
function v(a){console.log("run","#"+a.C,a.A);if(!a.g.length)for(;a.j.firstChild;)a.j.removeChild(a.j.lastChild);let b=r.filter(c=>a.o.includes(c.A)||a.o.includes("#"+c.C)).reduce((c,d)=>{console.log("merge","#"+d.C,d.A);/^p/.test(d.D)?c[d.D]+=d.P+"\n":c[d.N]+=d.P+"\n";return c},{html:"",css:"",js:"",pre:"",post:""});b[a.N]+=a.P;a.l.removeChild(a.u);a.u.srcdoc=w(a,b);a.l.insertBefore(a.u,a.s)}
function w(a,b){let c=/^[^{]+\{([\s\S]+)\}$/g,d=e=>'onerror="console.error(new URIError(event.target.'+e+'));"';return['<html>\n<head>\n<meta http-equiv="content-type" content="text/html; charset=UTF-8">\n<style>\nhtml,body{margin:0;padding:0;width:100%;height:100%;}',b.css,"</style>",...a.aa.map(e=>'<link rel="stylesheet" href="'+e+'" '+d("href")+"/>"),"<script>",l.toString().replace(c,"$1").replace("{o}",location.origin),"\x3c/script>",...a.ba.map(e=>'<script src="'+e+'" '+d("src")+">\x3c/script>"),
"<script"+(a.ca?' type="module"':"")+">",("perf"===a.D?m:p).toString().replace(c,"$1").replace(/(pre|js|post)\(\);?,?/g,(e,f)=>"\n"+b[f].replace(/(console[^)]+\);?)/g,(g,n)=>"perf"===a.D?"":n)+"\n"),"\x3c/script>\n</head>\n<body>",b.html,"</body>\n</html>"].join("\n")}
function x(a,b){a.g.push(b);a.T("log",a.g.length+".",Math.round(b),"ops");9>a.g.length?setTimeout(()=>v(a),5):(a.g.sort((c,d)=>c-d),a.T("log","ops/s median",Math.round((a.g[a.g.length-1>>1]+a.g[a.g.length>>1])/2),"avg",Math.round(a.g.reduce((c,d)=>c+d,0)/a.g.length)),a.g=[])}function y(...a){console.log("keep",a)}
function z(a,b,...c){let d=new Date,e=document.createElement("span");e.classList.add("snip-"+b);e.setAttribute("data-time",(new Date(d-6E4*d.getTimezoneOffset())).toISOString().slice(-13,-1));e.textContent=c.join(" ");a.j.appendChild(e);a.s.scrollTo(0,a.s.scrollHeight)}
class A{constructor(a,b=0){this.oa=a;this.C=b||++B;if(b=JSON.parse(decodeURI(a.getAttribute("data-snip")||(/(\{[^}]+\})/.exec(this.P.split("\n",1)[0])||[0]).pop()))){this.A=b.name||"";this.N=/language-(\w+)/.exec(a.className)[1].replace(/j.+t/,"js");this.D=b.hasOwnProperty("type")?b.type:"run";this.ca=b.module||!1;this.o=b.link||[];this.aa=b.css||[];this.ba=b.js||[];this.g=[];console.log("snippet",this.C,this.A);if("run"==this.D||"perf"==this.D)this.m=document.createElement("div"),this.m.classList.add("snip"),
a=a.parentNode,!1!==b.insert&&a.parentNode.insertBefore(this.m,a.nextSibling),this.h=document.createElement("span"),this.m.appendChild(this.h),this.h.addEventListener("click",c=>{switch(Array.from(this.h.children).indexOf(c.target)){case 0:v(this);break;case 1:document.fullscreenElement?document.exitFullscreen():this.m.requestFullscreen();break;case 2:this.wrap.classList.toggle("snip-nobody");break;case 3:this.wrap.classList.toggle("snip-noconsole");break;case 4:this.O--;u(this);break;case 5:this.O++,
u(this)}}),this.h.appendChild(document.createElement("div")),this.h.appendChild(document.createElement("div")),this.m.addEventListener("fullscreenchange",()=>{document.fullscreenElement?this.wrap.classList.add("full"):this.wrap.classList.remove("full")}),this.B=document.createElement("div"),this.h.appendChild(this.B),this.F=document.createElement("div"),this.h.appendChild(this.F),this.h.appendChild(document.createElement("div")),this.h.appendChild(document.createElement("div")),a=document.createElement("a"),
a.setAttribute("href","//snipp.et"),a.setAttribute("target","_blank"),this.h.appendChild(a),this.l=document.createElement("div"),this.m.appendChild(this.l),this.u=document.createElement("iframe"),this.u.setAttribute("sandbox","allow-scripts"),this.l.appendChild(this.u),this.s=document.createElement("div"),this.l.appendChild(this.s),this.j=document.createElement("div"),this.s.appendChild(this.j),!1===b.body&&this.m.classList.add("snip-nobody"),!1===b.console&&this.m.classList.add("snip-noconsole"),
this.O=+(b.height||12),u(this);r.push(this)}else console.log("invalid or missing options")}T(...a){let b=a.shift();"perf"===b?x(this,+a[0]):"keep"===b?y(...a):z(this,b,...a)}get id(){return this.C}get wrap(){return this.m}get frame(){return this.u}get console(){return this.s}get size(){return this.O}get P(){return this.oa.innerText.replace(/\u200B/g,"")}set module(a){this.ca=a}set H(a){this.ba=a}set pa(a){this.aa=a}}var B,r;k("Snippet",A);A.remove=t;B=0;r=[];
window.addEventListener("message",a=>q(a),!1);window.addEventListener("load",()=>new C);function D(a,b=document){return b.querySelector(a)}function E(a,...b){return F(a,"div","",...b)}function F(a,b,c,...d){b=document.createElement(b);b.setAttribute("aria-label",d[0]);c&&(b.innerHTML=c);G(b,...d);a&&a.appendChild(b);return b}
function H(a){I(a,a.S,a.Z);I(a,a.L,b=>"A"===b.target.nodeName&&a.Z()&&J(a,b.target.href));I(a,a.B,b=>b.target.classList.contains("cmd")&&K(a,b.target));(new Map([[a.ka,a.V],[a.ea,a.fa],[a.F,a.Y],[a.U,a.ha],[a.W,a.ia],[a.na,a.ja]])).forEach((b,c)=>I(a,c,b));I(a,document,b=>{(b.ctrlKey||b.metaKey)&&"rs".includes(b.key)&&(b.preventDefault(),"s"===b.key?a.Y(b):"r"===b.key&&L(a))},"keydown")}async function aa(a){ba(a);var b=location.hash.slice(1);b=20>=b.length?await M(a,b):await N(b);O(a,b)}
function I(a,b,c,d="click"){b.addEventListener(d,e=>c.bind(a)(e))}async function J(a,b){b=b.slice(b.lastIndexOf("#")+1);P(a);O(a,await M(a,b))}function K(a,b){switch(a.ga.find(c=>b.classList.contains(c))){case "delete":G(b,"del-yes");break;case "del-yes":ca(a);break;case "del-no":Q()}}function ba(a){a.h=JSON.parse(window.localStorage.getItem(a.A)||"[]");a.h.forEach(b=>R(a,b))}async function M(a,b){return a.h.some(c=>c.i===b)?(a.g=b,await N(window.localStorage.getItem("snippet-"+b))):{}}
async function N(a){try{return Object.fromEntries(new URLSearchParams(await da(a).catch(()=>({}))))}catch(b){return console.error(b),{}}}function O(a,b={}){console.log("load\n",b);document.title=a.l.value=b.t||"untitled";a.j=b.v||0;a.M={...a.la,...JSON.parse(b.r||"{}")};console.log("run",a.M);a.K.slice(0,-1).forEach(c=>S(a,c,{name:c,type:""},b[c]||""));S(a,"js",a.M,b.js||"");a.ma.appendChild(a.o.js.wrap);a.g?(a.J.appendChild(a.B),T(a.F,"no"),Q()):G(a.F,"no");U(a);L(a)}
function L(a){window.scroll(0,0);ea(a);v(a.o.js)}async function da(a){return await (new Response((new Response(Uint8Array.from(atob(a),b=>b.charCodeAt(0)))).body.pipeThrough(new DecompressionStream("gzip")))).text()}function S(a,b,c,d){let e=E(a.J,"code");F(e,"div",b,"lang");let f=F(e,"pre","","prism-live","line-numbers"),g=F(f,"code","","code","language-"+b);g.setAttribute("data-snip",encodeURI(JSON.stringify(c)));g.textContent=d;a.H[b]=e;c=new Prism.Live(f);a.G[b]=c;a.o[b]=new A(g)}
function T(a,...b){a.classList.remove(...b)}function Q(){T(D(".cmd.delete"),"del-yes")}function G(a,...b){a.classList.add(...b)}function U(a){document.title=a.l.value;a.da.innerHTML="v"+Math.floor(a.j/100)+"."+a.j.toString().padStart(3,"0").slice(-2).split("").join(".")}function P(a){a.g&&a.B.remove();a.g="";a.K.forEach(b=>{t(a.o[b].id);a.G[b]=null;a.H[b].remove()});a.o={};a.G={};a.H={}}
function ea(a){var b={js:[],css:[]};b=Object.keys(b).reduce((d,e)=>{Array.from(a.G.md.textarea.value.matchAll(new RegExp("^@("+e+")\\s(.+)$","gm"))).forEach(f=>d[f[1]].push(f[2]));return d},b);console.log(b);let c=a.o.js;c.H=b.js;c.pa=b.css}function ca(a){a.h.splice(a.h.findIndex(b=>b.i===a.g),1);V(a);D("[href='#"+a.g+"']",a.R).parentNode.remove();window.localStorage.removeItem("snippet-"+a.g);Q();a.V()}function fa(a){[a.L,a.S].forEach(b=>T(b,"hide"))}
function W(a){[a.L,a.S].forEach(b=>G(b,"hide"))}function R(a,b){a=F(a.R,"li","");F(a,"a",b.t).setAttribute("href","#"+b.i)}async function ha(a){return btoa(String.fromCharCode(...(new Uint8Array(await (new Response((new Response(a)).body.pipeThrough(new CompressionStream("gzip")))).arrayBuffer()))))}function X(a){history.replaceState(a,"","#"+a)}
async function Y(a,b=[]){var c=a.o.js;let d=!c.wrap.classList.contains("snip-nobody"),e=!c.wrap.classList.contains("snip-noconsole");c=c.size;return await ha(a.K.map(f=>f+"="+encodeURIComponent(a.G[f].textarea.value)).concat([...b,"t="+encodeURIComponent(a.l.value),"r="+JSON.stringify({...a.M,height:c,body:d,console:e})]).join("&"))}function V(a){window.localStorage.setItem(a.A,JSON.stringify(a.h))}function Z(a){G(a,"yes");setTimeout(()=>T(a,"yes"),750)}
class C{constructor(){this.A="snippets";this.K=["md","html","css","js"];this.ga=["del-yes","del-no","delete"];this.la={name:"js",type:"run",height:18,body:!0,console:!0,insert:!1,js:[],css:[],link:this.K.slice(1,-1)};this.g="";this.j=0;this.M={};this.H={};this.o={};this.G={};this.h=[];this.I=D(".header");this.J=D(".content");this.L=D(".menu");this.$=D(".menutools");this.X=D(".moretools");this.R=D(".menulist");this.S=E(this.I,"menubtn","hide");this.ma=E(this.J,"wrap");this.l=F(this.I,"input","","snippet-title");
this.l.placeholder="title...";E(this.I,"space");this.F=E(this.I,"save");this.U=E(this.I,"copy");this.ka=E(this.$,"create");this.ea=E(this.$,"about");this.W=E(this.X,"export");this.na=E(this.X,"import");this.B=E(null,"cmds");this.da=E(this.B,"version");var a=E(this.B,"cmd","delete");E(a,"del-space");E(a,"cmd","del-no");H(this);aa(this);a=document.createElement("input");a.setAttribute("type","search");a.setAttribute("aria-label","search");a.setAttribute("aria-description","search");a.style.visibility=
"hidden";document.body.appendChild(a);a=document.createElement("h1");a.innerHTML=document.title;a.style.visibility="hidden";document.body.appendChild(a)}Z(){this.L.classList.contains("hide")?fa(this):W(this);return!0}V(){W(this);P(this);O(this);X("")}async fa(){W(this);P(this);O(this,await N(await (await fetch("about.snippet")).text()));X("")}async Y(a){console.log("save",a.target);if(this.g){if(this.j++,a=this.h.find(b=>b.i===this.g))a.t=this.l.value,a.v=this.j,D("[href='#"+this.g+"']",this.R).innerHTML=
a.t}else this.g=Date.now().toString(36)+Math.random().toString(36).slice(2),this.j=0,a={i:this.g,v:this.j,t:this.l.value},this.h.push(a),R(this,a),T(this.F,"no"),this.J.appendChild(this.B),X(this.g);window.localStorage.setItem("snippet-"+this.g,await Y(this,["i="+this.g,"v="+this.j]));V(this);U(this);Q();Z(this.F)}async ha(){let a=location.origin+location.pathname+"#"+await Y(this);navigator.share({title:this.l.value,url:a}).catch(b=>{console.log(b);navigator.clipboard.writeText(a).then(()=>Z(this.U))})}ia(){let a=
this.h.reduce((c,d)=>{d=d.i;c[d]=window.localStorage.getItem("snippet-"+d);return c},{[this.A]:this.h}),b=document.createElement("a");b.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a)));b.setAttribute("download",this.A+".json");b.style.display="none";document.body.appendChild(b);b.click();b.remove();Z(this.W)}ja(){let a=document.createElement("input");a.type="file";a.accept="application/json";a.style.display="none";document.body.appendChild(a);a.addEventListener("change",
()=>{if(a.files.length){let b=a.files[0],c=new FileReader;c.addEventListener("loadend",d=>{try{let e=JSON.parse(d.target.result);e.snippets.filter(f=>e[f.i]).forEach(f=>{console.log(f);let g=this.h.find(n=>n.i===f.i);if(g&&g.v>g.v||!g)window.localStorage.setItem("snippet-"+f.i,e[f.i]),R(this,f),this.h.push(f),V(this)})}catch(e){}});c.readAsText(b)}});a.click()}};}).call(this);
